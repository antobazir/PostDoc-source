\documentclass[11pt,a4paper]{article}
%\usepackage[utf8]{inputenc}
%\usepackage[ascii]{inputenc}
\usepackage{geometry}
\usepackage[dvipsnames]{xcolor}
\usepackage{textcomp}

\begin{document}
\tableofcontents

\section{Introduction}
%re-read wang and see if something's missing
Mathematical modelling of complex systems has always been a subject of interest for scientists who wished to understand the underlying mechanisms of said systems in order to formulate predictions. In biology particularly, mathematical modelling of the mechanisms "running" life has been a hot topic as it generally involves several disciplines that used to be treated separately. Notable efforts including Turing's description of chemical reaction systems that can give rise to spatial gradients leading to morphogenesis %mettre dans la biblio "the chemical basis of morphogenesis

A lot of those efforts, however, were up until recently hampered by the fact that continuous model can only get so far in the description of complex systems with emerging properties. In the field of biology, notably, agent-based models have been used to explore modelling configurations that cannot be described satisfyingly with continuous models, especially in terms of emerging properties. The field has grown following the increasing availability computing power and has led to some conclusive modelling efforts and predictions in some area of the medical field.  

This document aims at providing a global view of agent-based modelling applied to biology and specifically tumour biology, along with information necessary in order to design the agent-based model that will be used  in the scope of the DIP2G project. First, a definition and a broad view of agent-based models in research and then more specifically in biology will be proposed. Then, the application of agent-based models to tumour growth studies and the attaining recent literature will be studied more specifically. In the third section, a detailed analysis of the different components of such agent-based model will be presented. Finally, a first outlook at the prospective model that will be used for the DIP2G project will be proposed.

\section{Agent-based model in biology : global view and recent literature results}
%broader defintion of agent-based model
As stated in \cite{ABAR201713}, "Agent Based Modelling and Simulation (ABMS) refers to a category of computational models invoking the dynamic actions,reactions and intercommunication protocols among the agents in a shared environment, in order to evaluate their design and performance and derive insights on their emerging behaviour and properties." This definition provides a framework versatile enough to describe and simulate various types of problems ranging from social science to ecology but also physics, chemistry and biology. ABMS can be especially well-suited to the study of emerging properties of complex systems spanning several scales in time, space and any another variable of interests. Though the following will focus more specifically on the application of ABMS in the field of biological sciences and related physical and chemical problems, plenty of tools exists across the board, going from implementation usable on desktop computers and laptops, to framework optimised to run on high-performance clusters and dealing with computationally expensive problems. 

%agent-based model taxonomy in biology (CA, Potts, on/off lattice etc...)
Two reviews form the basis of the classification of agent-based models that will be presented hereafter. The first was the review from Osborne and collaborators, which provides several examples along with the description of each model.\cite{Osborne2017} The second is the review from Rejniak and Anderson.\cite{Rejniak2011} This review focuses more on hybrid agent-based models used for tumor growth, (a subject that will be detailed further in this document). Lastly, the recent review of Metzcar also helped building this section.\cite{Metzcar2019} It however provides some types of model not mentioned in the review of Osborne and collaborators. The main features of each type of model will be introduced along with available recent bibliography to build up on the information found in their review. Other interesting review includes the works of Fletcher and collaborators,\cite{Fletcher2017} and the review of Norton and collaborators who focused on the application of agent-based models to the study of the interaction between the immune system and cancer.\cite{Norton2019}

\subsection{On-lattice models}
One of the very first features mentioned is whether the model is on-lattice or off-lattice. On-lattice model work with a set of fixed points in space. Notable examples include, \textbf{cellular automata} and \textbf{cellular Potts} models. In short, cellular automata generally associate one cell to one lattice site while cellular potts model typically associate a single cell to several lattice site, allowing cell geometry evolution in time and description of mechanical interactions. Cellular automata simplicity makes them suited to the study of a high number of cells with relatively reduced computational costs. Cellular potts model are a slighty more versatile alternative. The general structure of a cellular automata is to implement rule-based evolution with updates at different time step for each of the nodes of the lattice. The Hamiltonian-based cellular Potts model allows the inclusion of many features as long as they can be formulated to fit in the Hamiltonian. It should be noted that those designation proposed by Osborne and collaborators and used here are generally found in the literature. However, exceptions may be found, such as some specific being referred to as cellular automata while not having a fixed lattice.\cite{Adenis2020}

%What Osborne says about both in 
According to Osborne's group synthesis, Cellular automata and cellular Potts model are appropriate to the modelling of adhesion or any mechanism relying mainly on those effects. However, the lack of explicit compression mechanism in the formulation of cellular automata can prove limiting for certain applications where stresses undergone by the cells may be relevant. The nature of cellular Potts model makes description of mechanical stresses possible and therefore, the model can be more appropriate to model configurations where mechanical stresses are relevant. While the case studies in \cite{Osborne2017} were performed in 2D due to the shear number of simulations to perform, there exist 3D implementations of both cellular automata and cellular Potts model.

%(Recent results on potts model and cellular automata ?)
In recent years however, some notable works have been performed on cellular automata capturing some interesting features in development and growth. In this case, a certain degree of abstraction is imbued in the design of the rules. For example, in their studies Lehotzky and collaborators explain how to capture behaviours such as differentiation but also some types of cell migration with cellular automata.\cite{Lehotzky2019}\cite{Lehotzky2020} It should be noted that in these migration models, stochasticity maybe added to the equations in order to get a more realistic behavior.\cite{NavaSedeno2020} 
3D cellular automata found in the recent literature survey conducted for this study seem to be mostly used outside of biology, in fields such as wind flow modelling \cite{Byari2022}, geotechnical engineering \cite{Ozelim2018} or material science \cite{Ma2022}. Recent results in the biological field obtained with 3D cellular automata include a study on adenocarcinomas \cite{Tomeu2022} where a 3D cellular automaton used by Tomeu et al. captured the dynamics of breast ductal cells by encoding 4 distincts genes experession within the rules. A study on bacterial biofilms was performed by Machineni and collaborators in which they were able to reproduce features of bacterial biofilms growth with a cellular automaton.\cite{Machineni2017} Moreover, recently a specific cellular automaton code was developed in order to model cell migration\cite{Deutsch2021}. In summation, while equations maybe also encoded into them, the main features of cellular automata tend to be abstract rules derived from qualitative and/or quantitative observations of the system of interest.

There exist examples of cellular automata containing more than one cell per site that are not designated as cellular Potts model. An example of this can be found in the work of Piotrowska and Angus.\cite{Piotrowska2009} Their model is defined a cellular automaton where the site state is not simply defined as being occupied or not but by a integer number defining the number of cell. This makes the handling of cell division more straightforward. it obviously comes at the cost of considering all the cells in a site to be biologically identical. it should also be noted that while they model a 2D configuration, it is intended a layer of a 3D cell culture (cells at the center have limited access to nutrients).  Applications of this model to reproduce 3D spheroids data was conclusive.\cite{Angus2012}\textbf{[is there a way to make this model more "stochastic"?]} This approach was also used by Sottoriva and collaborators in order to study large populations of billions of cells in colorectal glands.\cite{Sottoriva2012}\cite{Sottoriva2015}\cite{Sun2017} Their 3D "many-cell-to-one-site" cellular automaton is then coupled to a zero-dimensional algorithm (crecmeth) handling mutation and construction of phylogenetic tree within the gland in order to derive information about population genetics. Their model model can simulate up to billions of cells by handling clusters of 5000 to 10000 cells, but this approach focuses more on population genetics that actual cell replication dynamics.

%read in more detail to see how they handle interaction with  nutrients and whatnot. like Arrebola in the first model

Some recent litterature on cellular Potts model exists as well. Cellular Potts model have been notably used for rheological applications as its energy minimisation type of alogrithm is well suited to the description of those systems.\cite{Villemot2021}\cite{Xu2021} Cellular Potts model have also been used to model various biological mechanisms such as angiogenesis in retina\cite{Vega2021} or single-cell motility.\cite{Wortel2021} Wortel and collaborators work is interesting as it uses both 2D and 3D models. While the 2D behaviour is well captured by the model, it appears the 3D behaviour is less well described, as the migration pattern do not match in vivo observation, suggesting that 3D model does not recapitulate the actual \textit{in vivo} migrating conditions. This question of the relevance of the 2D models is still an active research subject in the field today. Bridging the gap between the two fields mentioned above, some studies have also used cellular Potts model in order to model the glassy dynamics of biological tissues.\cite{Czajkowski2019}\cite{Sadhukhan2021} 

The next section focuses on off-lattice models. As will be detailed later, those tend to focus on phenomenon involving mechanics, cell migration being an example, more than on-lattice models. However, this is not an absolute rule and some migrations questions have been adressed with on-lattice models. A recent example is the model of Nan and collaborators which treated the question of cell shoving.\cite{Nan2018} They studied the specific mechanisms that can play a role in the migration of a cell surrounded by other cells with 2D cellular automaton. This illustrate how a properly designed cellular automaton can also be used to shed light on mechanism that have generally been represented in off-lattice models.

\subsection{Off-lattice models}
Opposite to the on-lattice models presented above, Osborne and collaborators designate the class of "off-lattice", lattice-free" or "cell-based" models. As stated in their article, "The removal of a fixed-lattice geometry in off-lattice models enables the more detailed study of mechanical effects on cell populations." With such a lattice-free approach, different approach to define cells can be employed. The two most obvious are "cell-center" approach and "vertex-based" approach. The "cell-center" approach is self explanatory, each cell within the model is identifed by the position of its center. The "vertex-based" model is an approach where the cell is defined by points of its membrane rather than its center. Another type of model is presented by Rejniak and Anderson which is designated as ellipsoidal cell-center model where the cell polarisation can be explicitly taken into account.\cite{Rejniak2011} 
In their review, Osborne and his colleagues present two cell-center models, the "overlapping spheres" model and the Voronoï tesselation model. A single "vertex-based" model. Here, we will present a broader view of recent research on off-lattice agent-based model. It includes different types of lattice-free model, which have been used in biology but also in other fields.

%recherche récente sur les off-lattice models
A model representing cells as overlapping disks has been used in order to describe the process of migration and cell aggregation on a substrate.\cite{Adenis2020}
Off-lattice models have been used by the group of Federico Toschi in order to understand population dynamics of bacteria populations in fluid flows. These models are quite different from the ones presented later especially on tumor growth but they are nonetheless defined as agent-based model due to the fact that they work at individual bacteria level.\cite{Plummer2018}\cite{Guccione2019}. Chen and collaborators have used an overlapping spheres model in order to map stress fields in tumors in order to study solid stresses in 2D.\cite{Chen2020} Similarly, Nestor-Bergmann and collaborators used a vertex-based model in order to map stress fields in 2D cellular monolayers.\cite{NestorBergmann2017} In the specific case of vertex models, an in depth mathematical study have been led by Hashimoto and collaborators in order to validate and consolidate the results on multicellular dynamics with vertex-based models.\cite{Hashimoto2017} Their study highlights how those complex models also need to be studied and validated from a mathematical point of view.

What generally comes out of the literature on such models is that they are used most efficiently when mechanics at the cell and/or tissue level are involved in the modelled phenomenon, and when mechanical variables are wanted as outputs of the model. The generally detailed mechanical modelling goes hand-in-hand with higher demand in computational resources since the equation of motion must be solved numerically at each step along with the state update for each agent. When coupled to other equations as will be detailed in the "hybrid models" section, the geometry of off-lattice models may be more convenient.  But as explained by Osborne and collaborators, even mechanisms that do not seem to be possible to integrate in a model can sometimes be modelled through the use of well-designed rules though any results obtained this way need to be analysed carefully.


\subsection{Comparative studies}
Beside the comparative performed by Osborne's group, other studies have been performed in order to compare the results of different types of model when it comes to describing specific biological processes. It is notably the case of cell migration. In their study, Nava-Sedeno and collaborators compared on-lattice and off-lattice model applied to the specific case of cell migration.\cite{NavaSedeno2020}  Their approach consisted in modelling the same phenomenon with the two types of model, and to determine the differences between the two originating from the type of model. The identification of such model-induced artifacts is important when it comes to interpretation of results and therefore this type of study allows for robust model validation.

The study of Chapelle and collaborators also focuses on migration.\cite{Chapelle2019} They used both on-lattice and off-lattice models and derived partial differential equations from the observed behavior by using a mean-field approximation on the output data of the agent-based model in order to investigate description of cell-cell pulling. Overall, they found singificant influence of the modelling choice. More specifically, it was found that the cell pulling mechanism had much less impact on population dynamics when incorporated into an off-lattice model than in an on-lattice model. It was also evidenced that the mean-field approximation of the population dynamics is less adequate with off-lattice models. This further demonstrate the importance of comparison between models on a same experiment. It also highlights the necessity of selecting input and output variables that are not only observable but also controllable to a degree.

An earlier study comparing on-lattice and off-lattice model was also performed for the modelling of angiogenesis. \cite{Plank2004} However, the approach there being more the description of the off-lattice model as a new tool for the study of angiogenesis the comparison, while useful is less extensive than the previously mentioned studies.

Another earlier study comparing 2D and 3D models was also proposed by Radszuweit and collaborators comparing 2D and 3D agent-based models for cell population growth. Their goal was to investigate a possible mapping between 2D and 3D model in order to lower computational costs.\cite{Rads2009} To avoid lattice artifacts typically encountered with square lattice, they used a Voronoï-tesselated on-lattice model in 2D and then extend this to 3D. It was found that a 2D on-lattice agent-based model could recapitulate the core component of growth and cell-cycle time distribution as well as a 3D on-lattice model at a reduced computational cost. It is specified, however, that more precise model would require 3D in order to be reliable. \textbf{[Pas compris les lattices artifacts lire ref 14]}

As of the writing of this paper, the authors have found no study comparing directly two types of model on the same tumor growth application. Therefore, performing such a comparison between at least two such models would not only be informative, but would also allow to discriminate between model artifacts and actual biological features, especially when model are used to expand on experimental data.

\subsection{Hybrid models}
Hybrid models are models that couple an agent-based model with another generally continuous model solved numerically on a grid that is often closer to the subcellular scale. Hybrid models can prove useful in deriving physical quantities not easily accessible with a "simple" agent-based approach or to sometimes include behaviours that would otherwise but hard to implement in a tractable manner with rule based-programming. This situation notably occurs when one wants to implement behaviours based on quantitative parameters not necessarily coded within the agent.

Fletcher and collaborators wrote a review describing some of those hybrid models in the scope of morphogenesis modelling\cite{Fletcher2017}. A notable example is how the mechanical contribution of the cytoplasm can be included by modelling the cell interior with finite elements "within" a vertex-based model. Another approach is the immersed boundary model. It was originally developped for heart valve and can be seen as a hybrid approach modelling a vertex model within a viscoelastic fluid.  It should also be noted that while Fletcher limits its description to 2D examples, 3D implementation of the immersed boundary model also exist and have been used, among other things, for the modelling of hemodynamics and single-cell dynamics.\cite{Ames2020}\cite{Guyot2016}\cite{Muller2021}. 

The group of Rejniak in particular focused on the immersed boundary model.\cite{Rejniak2007}\cite{Rejniak2012} This model is based on a similar principle to the one used by Fletcher's group. The immersed boundary model represents the intercellular and extracellular fluids as imcompressible fluids and the cells membranes as elastic materials. This is a more "natural" representation of cells and tissues. The trade-off is obviously a final model that is significantly more costly in computational terms. Therefore, beside phenomena clearly involving fluid dynamics. It can be useful to choose simpler model depending on what needs to be modelled. This question is explored in more detailed further in the document.

The last method detailed by Fletcher is the Subcellular element method. As stated by Milde and collaborators: "In the SEM, cells are represented by an agglomeration of computational particles whose interactions are defined via short-range potentials."\cite{Milde2014} This method subdivides cell membrane and cytoplasm in multiple elastic and viscoelastic subelements. Contrary to most off-lattice methods that model mechanic interaction at the cell-cell level, in that case, Newton's 2nd law is applied to the subcellular element. While earlier efforts modelled approximately 100 elements per cells,\cite{Newman2005} the number of elements of cells in the study of Milde and collaborators was varied between 1000 and 10000. Similarly to the Immersed boundary model, the increased amount of detail means that this type model cannot simulate large number of cells. It has been used mainly to gain more precise insight on the rheology of cellular processes.

Other approaches involve continuous  modelling a full concentration field or several concentration fields in a space sparsely field with discrete cell 'agent' such as performed by Boon and collaborators in order to study wound healing.\cite{Boon2015} Additionally, in some instances finite elements can be used to model tissues and their development,\cite{Oliveira2022} but also to model the continuous component of such hybrid models.

\subsection{Summary and conclusions}
\textbf{Figure/Flowchart of the big features}
To summarise what was presented above, when inquiring about the structure of an agent-based model, the first question is whether the model is on-lattice or off-lattice. For on-lattice models, then the next question is the lattice geometry. if the lattice is rectangular, then one has to define whether the implemented neighborhood in Von Neumann (4 neighbours) or Moore (8 neighbours). For off-lattice models, the first question is usually whether the model is center-based or vertex based. In both cases, then the mechanics needs to be modelled, generally through solving the equation of motion. The forces in the equation motion then depends on the modelled situation. Of course, the question of whether the model is 2D or 3D is important as well as it impacts both the computational cost and the potential relevance of the model. Whenever a 2D model is employed to model a 3D cell configuration, it should be verified if and how, the dimensional reduction impacts the results. In general, the approach whenever such models are used is to start with a somewhat minimalist representation. More model features are then added until the observed phenomenon can be described accurately, and discussion can be had about the underlying mechanisms and their representation by the model. In the next section agent-based model in relation to tumor growth will be presented.
%sous section de résumé et transition ?

\section{Agent-based models for tumour growth and therapeutic purposes}
%synthesis of limitations of continuous tumor growth model
In the previous section, agent-based models relevant to biology were presented broadly and classified. As will be shown in this section most of these models require calibration and/or comparison against experimental data in order to be validated. For example, tumor growth model are compared against actual tumor growth data in order to be validated. Therefore most models being developed are linked to an experimental study or sometimes to a "class" of model systems used in cancer studies. In this section, the relationship between agent-based modelling and some of the most frequently used model system in cancer studies will be presented. The review written by Chamseddine and Rejniak provides valuable insights about recent advances in the field with a focus on tumor biology compared to the more general review of and comparative study of Osborne's group.\cite{Chamseddine2019} Their review essentially summarise the important stages and phenomenon of tumor development and currently available therapies, with the associated agent-based model and how they helped advance research in that field. Another recent review is the one from Norton and collaborators.\cite{Norton2019} While the review of Rejniak and Chamseddine focused on hybrid models, Norton and collaborators state:" The computational models discussed in this review will largely focus on the adaptive immune system."
system."
%spehroids
\subsection{Agent-based model and Spheroids}
Multicellular tumor spheroids are 3D aggregates typically composed a few million terminally differentiated tumor cells. They became relevant in the last two decades as biological studies demonstrated the importance of mechanotransduction, and therefore, spatial arrangement of cell in the determination of the biological fate of cells. In that, context multicellular tumor spheroids represented a good middle ground between the complexity of an actual tumor and the accessibility and handiness of petri dish \textit{in vitro} cultures.\cite{Cui2017} 

Spheroids are harvested by placing cell in an environment that favors cell adhesion between themselves rather than addition to the substrate. They then aggregate through the interplay of the ECM, cadherins and integrins until the cells form  a tight structure whose characteristics can vary from cell line to cell line. Spheroids usually grow with an initial exponential phase before a necrotic core forms and the growth reaches a plateau. At this stage, \textit{In vivo} tumors typically starts vascularising, however, spheroids are usually studied before that phase. In the last two decades, spheroids have been used widely in order to study the effect of mechanical cues and/or to perform drug screeing on various cell types,\cite{Costa2016} or perform characterisation experiments.\cite{Margueritat2019}\cite{Leroux2015}  

Multicellular tumor spheroids should not be confused with tumor-derived spheroids, organoids or tumor-derived 3D cultures, which may be polyclonal and include stem cells. Multicellular tumor spheroids are generally monoclonal, generated from permanent/immortalised cancer cell lines, and grown in foetal bovine serum culture medium.\cite{Ishiguro2017} Other models like tumorospheres/tumorspheres generally require different medium with growth factors and are grown from stem cells.\textbf{[need to know what kind of model we are talking about then]} Modelling them will therefore involve the consideration of the differentiation process and the formation of subpopulations. In the following subsection the focus will be placed on models treating of monoclonal populations only. 

The modelling of tumor growth in general and of avascular spheroids have been widely studied over the last decade. Both continuous mathematical models and agent-based models. The goal mostly being to understand the underlying process and the impact of external factors on the growth of tumors by reproducing the growth dynamics. In order to evaluate models applied to spheroid growth it is important to understand the main features of spheroid growth that are verified across different cell lines. The first is the shape of the growth curve. \textbf{[check if Gompertz and or logistic growth work for all cell lines]} It is also generally observed that avascular spheroid go from an exponential phase to a saturated growth, with a sub-exponential phase in between.\cite{Freyer1988} There may also be pores forming within the spheroid core due to the competition between necrotic shrinking and adhesion forces.\cite{Metzcar2019}\textbf{[other ref needed for that]} \textbf{[find more refs and expand on that]}

An example of continuous model is the study of Watanabe and his collaborators who designed  a model that could mimick the growth pattern of tumors and reproduce some major features of the experimental data.\cite{Watanabe2016} Jin and collaborators designed a continuous model with different subpopulations that could recapitulate some important dynamics of the cell cycle.\cite{Jin2021}. Byrne and Drasdo proposed a comparative study between agent-based models and continuous model for population growth of cells in 2D focusing on the impact of adhesion.\cite{Byrne2008} The two types of model (agent-based and continuous) were found to be in agreement and the dynamics and saturation of growth were recapitulated through adhesion. Other models found the same dynamics by focusing specifically on nutrients availability.

This next paragraph will focus specifically on agent-based modelling of multicellular tumour spheroids. For the sake of conciseness, in the following the provided references will mostly be from studies published after the Osborne review presented above. However it should be noted that research on agent-based modelling of spheroids has been ongoing for more than a decade now with earliest works being published in the mid 2000s.  %read the 3 recent papers on spheroids

\subsubsection{On-lattice agent-based modelling on spheroids}
As explained earlier, on-lattice model are favored when computational resource is scarce or when a great number of agent must be included in the model \textbf{[??]}

%Arrebola
A recent sutdy on the on-lattice modelling of spheroid growth has been proposed by Ruiz-Arrebola and collaborators.\cite{Arrebola2020} On-lattice modelling of such systems is rather rare as it is difficult to include the mechanical effects in a straightforward way. The on-lattice model is of the cellular automata type as each cell is associated to a single site. This choice of model is motivated by the computational cost. Such design allows the simulation of aggregates up to millimeter sizes without requiring clusters. This model aims at describing precisely the growth kinetics with minimal details about the molecular processes and mechanical forces at play. In this model the included mechanism are proliferation, exfoliation and the diffusion of nutrients. The cell cycle itself is represented only by the simulation steps which can allow the handling of a large number of cells and long simulation  times. They validated their model through calibration and comparison with MCF-7 spheroids experimental data.

%Hamis
Another recent on-lattice study on spheroids is the one performed on the efficacy of hypoxia-activated prodrugs by Hamis and collaborators.\cite{Hamis2020} In this study, they also used an on-lattice cellular automaton in order to describe spheroid growth. Contrary to the previous model, The cell-cycle is modelled explicitly with all its phases for each cell, which is necessary in order to model the cell-cycle dependency of radioresistance. Instead of coding this through molecular network the length of cell-cycle phase is modulated by a function depending on oxygen concentration and parametrised with experimental data. Division is also handled in a more complex way. It depends in the number of free lattice in the vicinity. The nutrient (e.g. Oxygen) concentration and the HAP and activated HAP concentrations are modelled with coupled reaction diffusion equations. It should be noted that this model only distinguish between proliferative and non-proliferative cells, leaving out apoptotic and necrotic cells. The response the AHAP is modelled by increasing cell death probability above a certain threshold for AHAP concentration and the response fo radiotherapy is modelled with the widely used linear quadratic model. The model was calibrated for chondrosarcoma cells but can be calibrated with other cell types provided the needed data is available.

%Mao paper
Another approach to on-lattice study has been provided by Mao and collaborators.\cite{Mao2018} In their study, they used an hybrid on-lattice model, the impact of hypoxia on drug efficacy as well as radiotherapy and their combinaation on the growth dynamics of tumor spheroids. But they decided to use a hybrid model to represent the entire well and the surrounding medium in addition to the spheroid. This was done to provide a more realistic evolution of the oxygen concentration surrounding the spheroid. It should be noted that in this case, no agitation is modelled. Their approach is also original they used both monolayers and multilayer cellular cultures in order to estimate some parameters of their model instead of fitting spheroid data. While this recaptiulates the initial phase of growth satisfyingly, there are discrepancies above diameters approximating 800 \textmu m. \textbf{[Expand]}

%Cleri
The group performing this study published a previous paper on an hybrid agent-based model for tumor spheroid growth.\cite{Cleri2019} The cells in this model are delimited by Voronoi tesselation. Each cell has an attached state vector describing cell type, cell phase, cell volume, the local concentration of chemical species and accumulated cell damage. Interestingly, since the lattice is fixed this is technically an off-lattice model but with Voronoi tesselation. In terms of nutrients consumption, the glucose oxygen network is modelled in both a complete and reduced version. In both case the system is represented by a PDE system. Rather than reproducing faithfully experimental data from one cell type this study adopts the structure of an extensive sensitivity analysis centered on the parameters of the glucose/oxygen system. The goal of such model is to ultimately describe the growth of neurospheres originating from stem cells.

%jagiella
One noteworthy study is the work of Jagiella and collaborators.\cite{Jagiella2016} In their study they chose to study the growth control mechanims by focusing on variables extracted from several imaging modalities and comparing them to the output of an in silico growth model. Starting from a minimal cellular automaton, they gradually refined the model until they found the simplest model recapitulating their experimental data. Said data included the oxygen and glucose concentration but also less thoroughly studied variable in agent-based model studies such as lactate and the presence of ECM.\textbf{[Expand]} %is it stable ? etc...

As exemplified in the previous paragraphs, when it comes to radiotherapy response and drug response effects on spheroid and tumor growth in general, on-lattice agent-based model can give satisfactory results in terms of growth dynamics and they represent promising tools if coupled with experimental data. However certain phenomena and assays require the use of off-lattice models to be properly recapitulated.


\subsubsection{Off-lattice agent based model on spheroids}
Off-lattice agent based models are typically used when the mechanics of the system are strongly involved or required   as a readout variable.

%Bull
A recent example of off-lattice agent-based model was used by Bull and collaborators.\cite{Bull2020} Their model was implemented with the Chaste framework and their goal was to reproduce the inward flowing of beads observed in vitro within tumor spheroids by Dorie and other research groups.\cite{Dorie1982}\cite{Delarue2013} Cell can have four different phenotype : proliferative, quiescent, hypoxic and necrotic. Different phases of the cell cycle are not explicitly represented but its duration is set by a uniform distribution and depends on the oxygen concentration which is determined by a PDE and is the only nutrient represented in the model. In terms of mechanics the forces from other cells, surface  tension and random forces are included in the force balance. The maximum radius for the simulated spheroids was $\approx$ 200 \textmu m. One of their observations is that by changing the hypoxia threshold and/or the cell cycle duration, they observed that spheroid of the same size had different composition. They also found that bead trajectory also depended on those parameters,  suggesting that the microbead assay could help assess spheroid composition experimentally. Similar to the study performed by Cleri the goal here is more to understand the role of different parameters in the model rather than use it to complete experimental data after a calibration

%Ghaffarizadeh
Another example of tumor growth being studied with off-lattice model is the work of Ghaffarizadeh and collaborators.\cite{Ghaffarizadeh2017} In their work, in order to present the capability of the PhysiCell modelling tool, they studied different cases including the hanging drop tumor spheroids experiment, the growth of ductal carcinoma in situ, and a immune response model. In these three cases the agent-based model is an off-lattice model which includes an important number of features such as cell volume regulation, micromechanics, and cell death modelling including both apoptosis and necrosis. Contrary to several models presented in this section, PhysiCell explicitly models the cell fluid volume which is necessary in some applications but computationally costly. In this case, the only modelled chemical species is oxygen through the use of a reaction-diffusion equation coded in the BioFVM tool. It should be noted that PhysiCell allowed the simulation of 30 days of growth with up to 10$^6$ cells on a desktop station (i7 processor, 16 GB RAM). Interestingly in both hanging drop and ductal carcinoma in situ, the inclusion of stochasticity in the model resulted in the occurence of proliferating cells within the necrotic core, which has been corroborated by experimental observations\textbf{[find ref]}
%10^6 cells max on physcicell

%Kempf
The group of Kempf and Meyer-Hermann have developed an in-house model for various studies related to tumor growth. The model was first developed and presented in detail in a 2005 article. \cite{Kempf2005} The model was then used to study the response of tumor growth dynamics after irradiation.\cite{Kempf2010} The mechanics were modelled through a force balance including  an adapted Johnson-Kedall-Roberts (JKR) model for cell-cell contacts. It is also one of the few models to model cytokinesis in detail.\textbf{[verify]} To model response to irradiation they used the linear quadratic model coupled to cell-cycle and hypoxia-dependent sensitivities to radiation, and damage and repair dynamics. The 2015 study builds upon and refines the model to include cell density-dependent diffusion coefficient among other things. A typical simulation can last up to  30 simulated days and include up 10$^6$ cells in later studies which is consistent with PhysiCell capabilities. Although simulation duration one can assume it is of the same order as those reported by Ghaffarizadeh and collaborators.

%Rejniak
The group of Rejniak has developed an interesting variation of lattice-free agent-based model in last 15 years.\cite{Rejniak2007}\cite{Rejniak2012} As explained before the immersed boundary model (also referred to IBCell) is, in short, a vertex-based model where all interstitial spaces are filled with imcompressible fluid. Superficial tension, fluid forces,and interactions with the direct environment can then deform the boundaries. This model makes for a more natural (but nonethelss complex) representation of division if compared to previous models. It was applied to the specific case study of the growth a cross-section of spheroid in their 2007 article.\cite{Rejniak2007} While the growth of nutrient-driven tumors exhibits the expected three layers (quiescent necrotic and proliferative) No mention of the growth-saturation are made and the finger-like structure are not representative of what can be found experimentally or even in other models, suggesting that some ingredients are missing in this first version of their model.\textbf{[see if they find saturation with the other model]} \textbf{[weird stuff it does not seem to bug them that they have those dendritic style stuff? check by reviewing spheroid growth models and experiments]} %treat the following papers

Another interesting off-lattice strategy is that of an "adaptative" modelling scale adopted by Kim, Othmer and collaborators. In their initial model of tumors, they only modelled the proliferating layers, but with possible volume changes and ellipsoid geomtry which could change orientation depending to the stresses it underwent.\cite{Kim2007}\cite{Stolarska2009} This is close to what is done by PhysiCell, but with a non-spherical geometry and non representation of the inner fluid content. More recently the model was also applied to the case of Ductal Carcinoma in Situ also treated in the study of Ghaffarizadeh and collaborators.\cite{Kim2013} This model has been used in the recent study of Chen and collaborators.\cite{Chen2018} They demonstrated that their model could reproduce the cell movement and cell sorting observed by Dorie and collaborators but also studied the modelling of a cross-section of a monoclonal spheroid. They were able to reproduce the stable viable rim and obtained the three layer structure usually observed in 3D culture with a single cross-section.

%read A multilevel approach to cancer growth modeling

Literature on off-lattice agent-based model for the specific question of tumor growth is less profuse. Aside from studies like that of Bull that require mechanics due to the nature of the reproduced experiment, inclduing mechanics is often computationally costly and can be circumvented by efficient rule design with an on-lattice model. For example, in his work, Cleri recapitulated the stress-induced quiescence by applying the following rule: if a cell is confluent and/or in hypoxic condition for long enough it is switched to  quiescent state. Off-lattice model however, have been prominently used in fields like developmental biology where knowing precise representation of the forces and position of each object in the system is necessary.

[Include the fact that Drasdo reported the saturation but said that their model could not reproduce it. (in 2005)

%Organoids ?
\subsection{Agent-based models and Organoids}
While the DIP2G project does not use organoids it is interesting to understand how these can be modelled with agent-based model. As will be detailed in the following. Even if brain organoids have been studied \textbf{[ref]} in the context of diffuse midline glioma \textbf{[?]}, no agent-based model The handling and implementation of those system often containing several cell types and geometry more complex than the spherical shape usually implemented for spheroids may be informative for the needs of this study.

"The modern term organoid refers to cells growing in a defined three-dimensional (3D) environment in vitro to form mini-clusters of cells that self-organize and differentiate into functional cell types, recapitulating the structure and function of an organ in vivo (hence, also called “mini-organs”). Organoids can be derived from either embryonic stem cells (ESCs), induced pluripotent stem cells (iPSCs), or neonatal or adult stem cells (ASCs)." \cite{Corro2020}. As stated by Cacciamali and collaborators, "Organoids are classified into stem cells and tissue organoids.[...] Stem cell organoids can be generated from pluripotent Embryonic Stem (ES) cells and their synthetic induced Pluripotent Stem (iPS) cell counterparts and organ-restricted Stem Cells (aSCs).[...] Tissue organoids refer to mesenchymal cells and mainly apply to epithelial cells for their ability to self-organize into tissue structures also thanks to the development of growth factors that mimic the various organ stem cell niches. "\cite{Cacciamali2022} Organoids have been constructed several types of organ and can be used among other things to study the onset and evolution of cancer in models that reproduce to a high degree the structures and conditions encountered in in vivo tumors. Recent applications of organoids to cancer study include head and neck squamous carcinoma, \cite{Driehuis2020}, gastrointestinal cancer\cite{Vlachogiannis2018} and rectal cancer \cite{Yao2019}, among others. As for spheroids, the size and cell number of the system being simulated depends on the duration of growth. But as shown in the images presented in three previously cited studies organoids can acquire structure even with sizes of approximately 100-200 \textmu m. Such dimensions are tractable with existing agent-based models. 

Even though the literature is less extensive than for spheroids, agent-based models were used to study different type of organoids. Montes and collaborators wrote a review on the matter focusing on the available mathematical model used on organoids.\cite{Montes2019} This review includes agent-based and continuous models. On of the first general remark that can be made is that, contraty to spheroids, organoids tend to have non-spherical geometry which needs to be included in the models. The important role of stem cells and their differentiation process in organoids formation also means that in terms of structure, organoids agent-based models tend to have more complex rules for cells proliferation and differentiation.\textbf{[read the section on cerebral organids]}

Buske and collaborators designed a off-lattice 3D agent-based overlapping spheres model on growth of intestinal crypts \cite{Buske2011} and intestinal organoids.\cite{Buske2012} In this model, they represent the Wnt and Notch pathways in order to model lineage and differentiation. One of the important features of Buske's model is that they also model the basal membrane with a vertex type representation allowing them to specify mechanical properties for the surrounding environment. This model has also been used and adpated recently by Thalheim and collaborators. They studied the link between the Wnt and Notch pathways and the occurrence of cyst-like pattern formation in organoids.\cite{Thalheim2018}

In their study on crypt fission involving intestinal organoids, Langlands and collaborators used a 2D off-lattice cell-center voronoi tesselation model, itself based on a model developed by Dunn and collaborators (including Osborne)\cite{Dunn2012}.  In this model, the basal membrane is also explicitly modelled, and the mechanical properties of the basal membrane are recapitulated through the interaction of the stromal cell with the neighboring cells \textbf{[check]}. Another interesting feature of the basic model compared to others studied here is the link between cell death and anoikis.\textbf{Dunn model gives computation time data} Using this model and including different cell types they were able to reproduce the buckling occurring at the base of the crypts.\cite{Langlands2016} Almet and collaborators also used this model to study the link between cell stiffness and crypt fission.\cite{Almet2017} Their modelling strategy uses only a cross-section of the crypt. The computational cost of their simulation is therefore low. However, this assumption prevents them from studying cell sorting (as presented by Osborne and collaborators in \cite{Osborne2017}) and therefore forces them to encode a special division rule to circumvent this issue.

In contrast to the review of Montes, Karolak provides a review focused on mathematical models applied to oncology, which includes works on organoids including epithelial acini.\cite{Karolak2018} In that review agent-based models presented for orgaanoids mostly included 2d and 3D cellular automata used for the modelling of epithelial pattern formation. \textbf{[expand??? yes]} \textbf{[Can organoids be vascularised and should we mention co cultures ?]}

As shown by the review of Karolak and collaborators, and a search of the literautre, organoids applied to oncology is a potential area of development for agent-based models. Mixing the treatment of mechanical forces used in morphogenesis modelling with nutrients and pathway modelling used for tumor growth may shed additional light on important tumor growth mechanisms and could prove useful in assisting the personalised medecine endeavor organoids are already used for. The challenge is of course to include all the needed parameters in a system that needs to be large enough to be representative of oraganoids structure and size. 

\subsection{Angiogenesis and vasculogenesis}
Angiogenesis and vasculogenesis are two pivotal processes in the tumor development. Blood vessels are necessary for the tumors to get the sufficient amount of nutrients when they grow past a certain size. They are also vital in order to provide to the deep cell layers of the tumors. Angiogenesis is the process by which new blood vessels are formed. This process can be regulated by physical or chemical stimulation (typically through Vascular Endothelial Growth Factor (VEGF) pathway). Vasculogenesis is the process by which a new vessel is formed \textit{de novo} within a tissue through differentation of a relevant stem cell types (angioblasts or endothelial precursor cells)\cite{Karolak2018}\cite{Secomb2013}. Angiogenesis has been studied through the use of agent-based modelling as explained by Karolak and collaborators in their review. Vasculogenesis has also been the subject of agent-based models. The review of Metzcar and collaborators and that of Rejniak and collaborators on hybrid model also give some examples of model treating problems of Angiogenesis as well.\cite{Metzcar2019}\cite{Chamseddine2019}

%Angiogenesis
Angiogenesis has been studied from several angles with agent-based model. An interesting example for this work is the study of Shirinifard and collaborators which modelled blood vessels along with tumors cells.\cite{Shirinifard2009} Their model is based on a 3D cellular potts model. In this model they included both tumor cells and endothelial cells forming a vasculature and allowed the whole system to undergo angiogenesis, which is mediated through the concentration VEGF-A factor. A more recent effort in the same vein has been provided by  Phillips and collaobrators.\cite{Phillips2020} They used a 2D hybrid off-lattice agent based-model in which they represent both tumor and endothelial cells as agents and the nutrients and VEGF concentration as a continuous field. 


%Vasculogenesis
A notable  effort on vasculogenesis is the 3D, off-lattice hybrid stochastic model developed by Perfahl and collaborators.\cite{Perfahl2016}They achieved this by placing two "sprouts" of endothelial cells which then formed blood vessels. They modelled mechanical forces and chemotactic cues that can affect the tip cells of the vessel. They also modelled the same  vessel growth phenomenon within a 3D gel. The model yielded realistic dstributed network geometries.

%
Other studies take different approaches, such as that of Stephanou and collaborators who used an in vivo segmented vasculature as their starting point to study the impact of vascular endothelial growth factor on the network. They then couple a 2D cellular automaton with a hybrid discrete-continuous model for the vascular part of the simulation. \cite{Stephanou2017} Their specific goal in their 2017 study was to study the role of VEGF on the mechanical intergrity of blood vessels. They reproduced the changes of vasculature observed during tumor growth. However, the precise impact of vasculature remodelling on tumor growth remains to be elucidated. 

%a few words on those specific models
The models describing angiogenesis and tumor growth usually aim at understanding the interacting properties of tumor growth and the surrounding vasculature.  Angiogenesis and vasculogenesis, when studied through agent-based model are often subjected to two complementary approaches :  in the first approach  hypothesis are made about the vascularisation at the beginning of the simulation and its interaction with tumor cells is the main focus of study \cite{Phillips2020}. In other approach the vascular network development in  and of itself is the focal point and variables such as the resulting distribution of oxygen tend to be the output. \cite{Secomb2013}  As seen above this already requires the superimposition in the same model of the concentration fields and several types of cells each requiring specific rules (tumor cells, vessel tip and vessel stalk cells). The complexity of those models and their computational costs as they are often leaves the researchers to leave out the extracellular matrix (ECM) for now. However, including the effect of the substrate is often cited as a perspective of the studies mentioned in the present paper. 
\textbf{[find an agent based model focused on this]}.\textbf{[see the differences beyond that and put a sentence on for example the inclusion of flow and pressure]}

\subsection{Other model systems}
%Organs on a chip /bio reactors & MCL, cocultures?
Other promising model systems and tools have been developped for cancer studies. Examples include organ-on-a-chip systems in which complex cell structure are grown and linked through microfluidic systems which allows the application of precise chemical and mechanical cues compare to other types of cultures. Bioreactors essentially applies a similar principles but not based on microfluidics, which comes with advantages and limitations \textbf{[check and expand]}. Another example is multilayered cellular cultures(MCL). They are "MCL, multilayered cell cultures (MCC); are planar aggregates of tumor cells grown on porous support membranes in culture medium which are a model for the extravascular compartment of solid tumors considered to more accurately reflect the tumor microenvironment than monolayer cultures." \cite{Schwab2011} This systems have indeed often been used to assess extravascular diffusion \cite{Al-abd2008}, sometimes to provide parameters to a separated agent-based model\cite{Hong2018}. However, no literature was found on the application of agent-based model to the precise case of MCLs. The previous remark applies in fact to all previously mentioned models.

Finally, the author wants to mention the case of cocultures. Cocultures are often useful to capture some behaivors that cannot be reproduced only with chemical biomechanical cue on a single cell type. It can therefore be useful to define several cell type in a single agent-based model in order to reproduce those effects. Ji et al. produced a recent study in the case of myeloma cells and bone marrow.\cite{Ji2016} Their agent-based model was a 3D hybrid on-lattice hybrid cellular automaton in a cylindrical geometry with 5 types of agents in order to represent the coculture. With this model they were able to reproduce experimental observations related to the impact of the immune system contribution and the interactions between multiple myeloma cells and bone marrow. Teir approach is notable as it includes a fairly extensive ODE system with 7 ODEs for the bone marrow singalling pathway and 9 ODEs for the Myeloma-initiating cell. This consequently led to important computational costs and required extensive sensitivity analysis.


\section{Typical agent-based model structure in relation to cell phenotype}
In the previous section a broad view of agent-based model and their relation with some typical model systems used in oncology was presented. The behavior of agents in those models is deisgned to recapitulate the individual behavior of cells and their interactions ,at least those relevant to the studied phenomenon. Depending on the type of model, the implementation of those features of the cell behavior can vary widely. Those differences in implementation can result in a range of simulation artifacts. In this section, the main features and their various implementations encountered in the literature will be presented. As the group focuses on tumor growth and its relation to hypoxia and radiotherapy.\cite{Rakotomalala2021}\cite{Goy2022} Therefore, the recapitulated features will focus on this specific application.

\subsection{Cell-cycle representation}
According to \cite{Cooper2000}, in eukaryotic cells, what is referred to as cell cycle is defined as follows:"the cell cycle is divided into two basic parts: mitosis and interphase."  Mitosis encompasses the separation of genetic material and cytokinesis. The interphase in separated in 3 phases :  
\begin{itemize}
\item{G1 phase} "(gap 1), which corresponds to the interval (gap) between mitosis and initiation of DNA replication."
\item{S phase}  "(synthesis), during which DNA replication takes place."
\item{G2 phase} " (gap 2), during which cell growth continues and proteins are synthesized in preparation for mitosis. "
\end{itemize}
"The duration of these cell cycle phases varies considerably in different kinds of cells. For a typical rapidly proliferating human cell with a total cycle time of 24 hours, the G1 phase might last about 11 hours, S phase about 8 hours, G2 about 4 hours, and M about 1 hour."\cite{Cooper2000} Finally, the quiescent or G0 phase should be mentioned. In this phase, cells "remain metabolically active but no longer proliferate unless called on to do so by appropriate extracellular signals." in this subsection, the different representation and implementation of the cell cycle in the tumor spheroids-oriented models will be presented.


%phases 
All phases of the cell cycles are not necessarily represented explicitly.\cite{Jagiella2016} The timestep of the simulation can be taken as one cell cycle.\cite{Arrebola2020} The cell-cycle may also be represented by a single event such as division\cite{Bull2020}, possibly with a growth phase in between.\cite{Mao2018} Whenever a cell-cycle dependent parameters needs to be modelled, all phases cited above are generally represented.\cite{Hamis2020}\cite{Tomezak2015}\cite{Cleri2019}\cite{Ghaffarizadeh2017}.

%transition between phases
When full cell-cycle is not explicitly modelled, cell state can be made to alternate between different states not necessarily matching those of the cell cycle.\cite{Arrebola2020}\cite{Mao2018}\cite{Jagiella2016}\cite{Bull2020} The transition between cell phases can be deterministic\cite{Tomezak2015}\cite{Cleri2019}\cite{Kempf2005} or stochastic. Stochasticity may be encoded into the entire cell cycle duration\cite{Hamis2020} or into the duration of each represented phase.\cite{Jagiella2016}\cite{Ghaffarizadeh2017}

\subsection{Cell division \& proliferation}
The first and most obvious feature of an agent based-model in biology is cell division. However, modelling something as integral to any biological study as cell division is not trivial.

%is division condition
First in order to divide, cells needs to be in presence of a sufficient amount of nutrients. In models where no nutrients concentration fields are represented, other ways of determining whether cells divide  can be used. For example, in the study of Arrebola and collaborators,  the state of cells is determined by their distance from the rim of spheroid.\cite{Arrebola2020}\cite{Jagiella2016} Another "geometrical" criterion used has been a threshold on the proximity of a vacant site.\cite{Hamis2020} When nutrient concentration fields are explicitly represented, a threshold can determine whehter a cell divides or not.\cite{Cleri2019}\cite{Bull2020} When mechanics are explicitly modelled the proliferative state may also by conditioned by a stress threshold as well \cite{Kempf2005}. Otherwise a condition on confluence may be used to represent the role of mechanical cues in the switch to a proliferative or non-proliferative state.\cite{Cleri2019} Cell volume, which is controlled by the amount of available nutrient has also been used as a criterion for the triggering of cell division.\cite{Mao2018} In that case, it is as if cell are constantly in G2 phase and switch to a deterministic M-phase when the threshold size is reached. It is also possible to integrate these conditions by weighting the transition probability of the cell cycle .\cite{Ghaffarizadeh2017}

%division temporality
In most models, cells in proliferative state may divide following a stochastic process modulated by probability distribution\cite{Arrebola2020}\cite{Jagiella2016}, occur in the M-phase or at the end of the cell cycle when it is explicitly modelled\cite{Kempf2005}\cite{Hamis2020}\cite{Ghaffarizadeh2017}, or a mix of both.\cite{Tomezak2015}\cite{Cleri2019} It should be noted that in some cases relying on stochastic decision-making, division does not necessarily occur in the M-phase.\cite{Tomezak2015}\cite{Cleri2019}\cite{Jagiella2016} Cell division can also be instantaneous when the required criterion is reached\cite{Mao2018}\cite{Bull2020}, or at the end of M-phase.\cite{Hamis2020}

%division handling
A final important information about division is how the apparition of the new cell in the physical space of the model is handled. This is obviously handled very differently in on-lattice and off-lattice models. In on-lattice model, if division is allowed, the new cell can "shift" neighboring cells to make space if needed \cite{Mao2018}\cite{Tomezak2015}\cite{Cleri2019}, placed in the closest free site in a proliferative area \cite{Arrebola2020}, or simply randomly in the closest free site\cite{Hamis2020}\cite{Jagiella2016}. Another noteworthy approach is that of Piotrowska and Angus who circumvent the issue by allowing the presence of several cells in one site.\cite{Piotrowska2009}. In off-lattice models, the inclusion of mechanics can make the inclusion of division more straightforward. The newly formed cell can simply push mother and neighbor cells away.\cite{Bull2020} Another approach is to consider two daugther cells spaced by an equal amount from the mother cell position\cite{Kempf2005} possibly taking into account the polarisation of the mother cell.\cite{Ghaffarizadeh2017}. However, depending on how the mechanics are coded into the model this approach may require additional efforts to avoid unphysical stresses due to division.\cite{Kempf2005}\cite{Kempf2010}

%ongenae here ?

\subsection{Cell death}
In the spheroid agent-based model one or two mechanisms of cell death are modelled: apoptosis and necrosis. Apoptosis is also referred to as programmed cell death and is the process of shrinkage of of DNA and cytoplasm leading to the removal of the cell without damage to surrounding tissue and necrosis is the swelling and bursting of a cell (lysis) that has undergone damage or injury.\cite{Alberts2002}

\subsubsection{Apoptosis}
%condition and timing 
The nature of cancer cell makes them less subject to apoptosis than healthy tissue, meaningthat apoptosis is not necessarily represented in all models.\cite{Arrebola2020}\cite{Hamis2020}\cite{Cleri2019}\cite{Bull2020}\cite{Mao2018} Apoptosis is the only cell death mechanism modelled by Tomezak and collaborators.\cite{Tomezak2015} It can be triggered stochastically with a probablity linked to the amount of damage the cell has received through radiation. Ghaffarizadeh and collaborators implemented apoptosis in the scope of their immune response study.\cite{Ghaffarizadeh2017} In that case, apoptosis can be modelled as shrinkage of cell contents since they are explicitly in the PhysiCell model. Cell then disappears from the model once its volume falls below a certain threshold. It should be noted that the role of apoptosis is often neglected but has proven to play a part in tumor dynamics in experiments. \textbf{[find ref]}

\subsubsection{Necrosis}
In the model of Arrebola, Necrotic state is only encoded by the cell position in the spheroid and manifest itself through a volume coefficient in the total volume coefficient.\cite{Arrebola2020} In the study of Hamis and collaborators, cell death occurs only if a sufficient concentration of Hypoxia-activated prodrugs are present.\cite{Hamis2020} Cell death can then be represented in three different ways: no removal, instant removal or delayed reomval. This, however did not qualitatively impact their main results. In the model of Cleri, Necrosis occurs in a determinsitic  way if a cell spends enough time in hypoxic condition.\cite{Cleri2019} It should be noted that in that case the necortic cells ceases consumption but is not removed from the simulation. In their study, Bull and collaborators handle necrosis similarly, however, the cell is removed from the simulation after a certain duration.\cite{Bull2020} In the  model of Mao, cells are put deterministically in a necrotic state if they are starved for too long and removed after a given time.\cite{Mao2018} Necrosis can also results from radiation damage in this model. In the model of Jagiella, glucose/oxygen then ATP-induced cell death were tested however the best agreement with experimental data was found by making lactate concentration induce necrosis.\cite{Jagiella2016} Ghaffarizadeh and collaborators studied the differences between stochastic and deterministic necrosis linked to an oxygen threshold.\cite{Ghaffarizadeh2017} In their first model, Kempf and collaborators conditioned a stochastic necrosis to a threshold on the product of glucose and oxygen.\cite{Kempf2005} In a latter model while anoxia is tolerated for extended times glucose depletion triggers necrosis.\cite{Kempf2015}
%"Typical" structure of growth model 

\subsection{Nutrients \& short-range \& long range signalling}
%introduction on cell respiration
An extensive description of the metabolic pathway is beyond the scope of this review. This subsection will thus focus mainly on glucose and oxygen as they are the most commonly modelled nutrients. ATP can also be included in certain models with a more complexe reprensatioin of metabolism.  Adenosine Triphosphate (ATP) can be produced through glycolysis in aerobic conditions and through fermentation in anaerobic conditions which leads to the production of lactate. The production of ATP and ADP from oxygen and glucose is called the glucose-oxygen network. It is the most commonly modelled metabolic system in agent-based modelling applied to tumors. 
%modelled nutrients& dynamics
%single nutrient model
An important feature of any model related to tumor growth is the nutrient concentration. An extended representation of the cell energy consumption cycle or cell respiration was provided by Cleri and intended to be used in its model \textbf{extend later}.\cite{Cleri2019} However, most models opt for simpler representation of nutrients.  In the model of Arrebola, the only modelled nutrient is oxygen and it is not explicitly modelled.\cite{Arrebola2020} The nutrient concentration in this case is linked to the distance between the rim of the spheroid and the cell. A more widespread approach is to couple a reaction-diffusion equation to the agent-based model in order to represent nutrient and/or other chemical species. In the model of Bull, only the oxygen is represented and its concentration follows a standard diffusion-reaction equation with the cell-centers acting as point sinks.\cite{Bull2020} In their study, Ghaffarizadeh and collaborators also focused on oxygen which was handled by the BioFVM tool coupled to PhysiCell and which encodes a full reaction-diffusion equation with decay, sources and sinks.\cite{Ghaffarizadeh2017}

%multi nutrients models
In their first model, Kempf and collaborators use 2 diffusion-reaction equations to describe the dynamics of glucose and oxygen in the system.\cite{Kempf2005}. In their more recent publication they included a refined modelling of diffusion which accounts for the tissue properties impact on diffusion.\cite{Kempf2015} In the model of Hamis and collaborators, diffusion-reaction eqautions are used to represent both the oxygen and the hypoxia-activated prodrugs.\cite{Hamis2020} For oxygen, the rim of the spheroid is treated as an ensemble of source points and cells are treated as sink with a specific consumption rate. In that case, the diffusion coefficient depends on whether the lattice is occupied by a cell or not. The equation is almost the same for prodrugs except they have an additional term for activation and decay of the compounds. Mao and collaborators also studied the effects of hypoxia-activated prodrugs on spheroid growth with an-on lattice hybrid model. In their case however the oxygen source is the gaseous environment above the culture medium which is completely represented. An equation of diffusion gives the oxygen concentration in the medium and a diffusion-reaction sets the concentration within the spheroid. As explained above in order to recapitulate all the imaging data they acquired, Jagiella and collaborators needed to included glucose, oxygen but also lactate into their model.\cite{Jagiella2016}

%Cleri 
In his model, Cleri gave the equation system for the entire glucose/oxygen system.\cite{Cleri2019} This includes reaction-diffusion equations for glucose and oxygen and Michaelis-Menten and ordinary differential equations for the intermediary compounds. However, this extended system gave results that were difficult to analyse and interpret. Therefore a reduced metabolic equation system was proposed keeping only glucose, oxygen, ATP and ADP as variables. The resulting equations system was then succesfully calibrated and tested in growth simulation. But contrary to Jagiella, cellular waste is not represented.

\subsubsection{Petri Nets, boolean networks and other regulatory network representations}
The end goal of hybrid models and their representation of nutrients is ultimately to capture at least partially the complex regulatory machinery of the intracellular signalling pathways. As exemplified above, this tends to be achieved with system of ordinary differential equations solve numerically. One of the main problem with this method is that the coefficients of these equations tend to be difficult to retrieve in physiological condition. This means that in order to find values for those parameters, the most commonly used is to sweep the parameters in range of values until the simulation fits the experimental observations. In the following two of the existing method used to replace the ordinary differential equations will be presented.

\textbf{Petri nets} represent a method of modelling that represents the cell signalling pathways as bipartite graphs. Proteins, ions and enzymes are represented as "places", and the reactions by which they interact as "transitions". Places and transitions are linked by arcs. The application of this framework, and more specifically stochastic Petri nets, to biology was proposed and detailed by Goss and Peccoud.\cite{Goss1998} The dynamical aspect of the system is represented by "Tokens" which are number affected to each places and are equivalent to the number of molecule in a biochemical context. Statistical analysis and graph theory tools can then be used to derive information about the steady and transient of the modelled system.

A quick survey of litterature shows that few studies have considered implementing both agent-based model and petri net models for signalling pathway. Santoni and collaborators studied the differentiation of lymphoctye population in the context of hypersensitivity by using both an agent-based model and a petri net model.\cite{Santoni2008} In the agent-based model, they represented macrophages along with the different type of lymphocytes. The Petri net took as input the level of certain chemokine and implemented the complex signalling pathway resulting in different differentiation scenari for the lymphocytes. They managed to reproduce the main aspects of the studied behaviour.  %lookup the difference between deterministic constant and stochastic rate

Another type of representation of the cell regulatory network not using ordinary differential equations are the boolean networks. It is interesting to present them next to the Petri nets as both approach are based on a graphical representation of the regulatory network. But while the Petri nets uses graph theory to analyse the system, Boolean networks is used to derive logical equivalent to the network.\cite{Thomas1995} Studies have focus on demonstrating the links between boolean networks and systems of ODEs used to describe the regulatory networks in biology. \cite{Davidich2008}

A recent effort linking boolean network and agent-based model, is the work of Voukantsis and collaborators. It is noteworthy as their microC framework models both the cells and their inner regulatory network with agent-based models.\cite{Voukantsis2019}. As stated by Voukantsis and collaborators, "We distinguish between four types of nodes: genes, receptors (input), output nodes, and fate-decision nodes. Genes have both incoming and outgoing links, receptors have only outgoing links, and output and fate-decision nodes have only incoming links. Cell-fate decision nodes have a crucial role in the simulations as they trigger the actions that determine the cell behavior." Their implementation is quite different from what is usually found in literature so far. They separate the 3D-space in voxels, which themselves contains cells (also modelled as agents), diffusible substances and the regulatory network. This approach reportedly includes the spatial dimension within the cell and models the interaction between chemokine and regulatory network. In other models, when included, such mechanisms tend to be recapitulated by a rule which  does not necessarily account for the spatial component below the cellular scale. This allowed them to model mutations precisely and observe their impact on spheroid growth \textit{in silico}.

While those approaches are obivously better suited for questions where molecular component are prominent, they obviously come with a higher cost in terms of implementation and analysis. Moreover, as explained by Voukantsis and collaborators it can be difficult to build an exhaustive network if the data is not available. This might lead to bias results in the analysis. \textbf{It would nevertheless be interesting to compare the merits of those approach on a somewhat simple case tractable with at least one of the two approaches mentioned above and with the more standard ordinary differential equations system.} In that regard, the PhysiBoSS software proposed by Letort and collaborators constitutes a potentially valuable tool for potential future studies.\cite{Letort2018} To validate their tool, the groupe reproduced the response of spheroid growth to Tumor Necrosis Factor.

%\textbf{[read this in more detail at some point]}

\subsection{Cell-cell Mechanics \& Cell-environement mechanics}
%intro & définitions
% in the model of Byrne cell random walk until they meet one another then adhesion can happen but with  a waiting time etc... and adhesion means that they need to go further 2 radius to fully separate
Healthy and tumor cells reacts to their mechanical microenvironment through dedicated regulation pathways. A interesting phenomenon illustrating this is anoikis. Anoikis is a form of programmed cell death occuring when cells are completely detached from extracellular matrix. As it constitutes an obvious barrier to phenomenon such as metastasis, this singalling pathway is impacted by carcinogenesis.\cite{Paoli2013}\cite{Raeisi2022} Though they will not be the focus of this section it should be noted that agent-based model including anoikis exist.\cite{Ingham2017}\cite{Campenni2020}

Anoikis, along with another phenomena relying upon the influence of mechanics on important signalling pathways, explain in part why the biological relevance of 2D cell culture is less than that of 3D cultures. In that section, the modelling of mechanical interactions between cells will be developed. In models where it is implemented, the modelling  of the interactions between cells and the environement will also be treated. In the specific case of spheroids, their initial aggregation and later compaction can be modulated by the binding of extracellular matrix and integrins and cadherins depending on the cell line.\cite{Cui2017} The role cell-cell adhesion in development of tumor spheroids with agent-based model is part of the questions that were  adressed in the study of Andasari and collaborators.\cite{Andasari2012} Their model is interesting as it explicity represents catenin expression and conditions adhesion to its concentration. It also underlines how important it is to use multiple models when possible in order to better understand the underlying physics. 


The importance of the matrix in the determination of cell biology means that spheroid grown with and without matrix may exhibit significant differences in their behaviour. It is therefore important to know the culture method in order to properly capture the features of the system  in a model. The importance of cell-matrix interactions have already been underlined in the section dedicated to angiogenesis and vasculogenesis. Cell interacts with their environment notably through the binding of matrix with transmembrane integrin proteins. The binding of intergrin or lack thereof can significantly change the behavior of cells.\cite{Cui2017} For example, Hyaluronic-acid-ased scaffolds may also promote cancer proliferation and spheroid formation.

Mechanics are left out of the presented on-lattice models. Mechanics, if included an on-lattice model, are generally included in cellular potts model where they can be incorporated in the Hamiltonian equation describing the components of the system and their interactions.\cite{Osborne2017}\cite{Shirinifard2009}

%separate cell-cell and cell matrix ?
In the model of Bull and collaborators, the mechanics of the model are derived through application of Newton's second law. In their model, cells are subjected to mechanical forces from their number, random forces resulting from diffusion and heterogeneity from the environnment and surface tension forces.\cite{Bull2020} In their 2005 and 2010 studies, Kempf and collaborators used a similar model, however forces were represented differently. Forces were divided between "active" chemotactic forces, viscous drag forces resulting from interactions between the cell and extracellular matrix and cell-cell interactions described by the JKR model.\cite{Kempf2005}\cite{Kempf2010} In their study, Ghaffarizadeh and collaborators detail PhysiCell handling of mechanics : Adhesive and repulsive forces are modelled between cells and between cell and basal membrane. The two other contributions are drag forces originating from fluid and ECM viscous interactions, and active forces from cell locomotion, which corresponds to the chomotactic forces from other studies.\cite{Ghaffarizadeh2017} The model of Bukse and collaborators includes the effect of the basal membrane by including a basal network of nodes which can interact with cellular agent during organoid formation. The models of Perfahl et al. and Stephanou et al. also modelled the interaction with matrix for the study of vasculogenesis.\cite{Perfahl2016}\cite{Stephanou2017}. In the former, matrix was modelled as agent interacting with endothelial cells. In the latter, matrix was included through a 3D field representing the concentration of fibers in the hybrid component of the model treating vascularisation. Other models cite above generally use viscoelastic interactions between  cells and the matrix  Another interesting model is that of Byrne and Drasdo.\cite{Byrne2008} It is one of the models that takes an initial situation where adhesion is fully represented during the simulations. Cells can be placed in the simulation as a sparse suspension which then undergo random walk until they meet a neighbor to which they can bind through the modelled cadherin binding. In that case, cell may also be unbound if they undergo sufficient stress pulling them away. It should be noted that the random walk can be added to PhysiCell models as well. More recent studies using agent-based model and adressing the question of aggregation with off-lattice models have been conducted by the group of Smeets.\cite{Smeets2020}\cite{Ongenae2021}
%Oriola explains how the "fluctuations" happen in the agent-based model but does not really fit here otherwise
 
\subsection{Radiotherapy and associated damage mechanisms}
As explained by Rakotomalala and collaborators,\cite{Rakotomalala2021} "The mechanism of action [of radiotherapy] relies on ROS production, notably through water radiolysis, and DNA damages induction, especially double strand breaks (DSBs), leading to cell death." They also present the 6 Rs of radiotherapy which describe the response of tumors cells to irradiation. The 6 RS are:"\textit{Repair}, refers to the cell capacity to survive by repairing radio-induced damages (particularly DSBs), in theory, more characteristic of healthy cells; \textit{Repopulation}, refers to the tumor cells capacity to grow following a radiotherapy fraction; \textit{Redistribution}, refers to the progression of cancer cells from radioresistant cell cycle phases (i.e., G1/S) toward more radiosensitive phases (i.e., G2/M), between radiotherapy fractions; \textit{Reoxygenation}, refers to the oxygen level recovery following irradiation, due to well-oxygenated cells death and tumor vascularization; \textit{Reactivation}, refers to the triggering of a systemic anti-tumor immune response following irradiation-induced immunogenic cell deaths." Their study also demonstrates that, among other things, hypoxia leads to increased resistance of tumors to radiotherapy. Several studies using agent-based model focus on the response of tumor cell populations to radiotherapy. In terms of population dynamics, the response of tumor cell population is often descirbed by the linear quadratic model presenteded by Enderling and collaborators.\cite{Enderling2010} In the following, the mechanisms and their implementation in the previously treated studies will be detailed.
In terms of radiation therapy in and of itself, one should distinguish between low and high linear energy transfer (LET). As explained  by Tomezak et al. :"The correlation between radiation energy delivery and ionisation density is the linear energy transfer (LET). High-LET radiation, such as protons or alpha particles, have a high ionisation density along their path, however running along very straight tracks. Conversely, low-LET radiation, such as photons or low energy electrons, produce a much lower density of ionisation events per unit length, however their path is very diffuse and random, therefore their energy deposition is more homogeneous in the cell volume." \cite{Tomezak2015} in general, medical radiation is low-LET radiation.

The main impact of the previously mentioned radiation is how it damages DNA structure in cells. It also damages RNA and other cell components, potentially linking to some forms of cancer,\cite{Haruehanroengra2020}\cite{Uddin2020} but such damage has not been studied as much as DNA damage. DNA damage due to radiation can be direct, with the bases being directly modified chemically by the impact of radiation, or indirect through the generation of reactive oxygen species which can then react with the bases and damage them. The induced damage can be either  single-strand breaks(SSB) or double-strand breaks(DSB). double strand breaks are the most deleterious of the two and can trigger cell death.\cite{Kuster2019} close single-strand breaks may "fuse" to form a double-strand break.\cite{Cannan2015} Transcription and replication can also be sources of the double-strand breaks.

%implementation
Arrebola and collaborators do not present any results about irradiation, however they detail how it might be implemented in subsequent work through the use of a survival function affected to irradiated cells.\cite{Arrebola2020} Hamis and collaborators modelled cell response to radiotherapy through the use of the linear quadratic model. The cell specific sensitivity parameters were tuned to the oxygen concentration.\cite{Hamis2020} The same formulation was used by Mao and collaborators in their model.\cite{Mao2018} It was also used by Kempf and collaborators in their study on the effect of cell synchronisation on response to radiotherapy.\cite{Kempf2013}  Cleri and Tomezak chose to model single-strand break and double-strand break explicitly for each cell, and relate cell-death probability to the discrete number of damages suffered by each cell.\cite{Tomezak2015}\cite{Cleri2019} However, no radiation experiments were performed in their study.

\subsection{Immune response}
%modelling of all the aspects : cell growth, cell mechanics, distribution and diffusion of nutrients, cell-cell signalling, division 
A significant part of this subsection is based on the review from Norton and collaborators.\cite{Norton2019} One of the ways cancer interacts with the immune system is by suppressing immune response. Either by blocking the action of T-cells or by exhausting them. Tumor can also recruit macrophages to aid their development, along with other cell types associated to innate immune response like neutrophils and eosinophils. The interplay of molecular and cellular processes in the role of tumor development is an extremely complex phenomenon that requires multiscale studies in both time and space. This makes agent-based models and especially hybrid ones suited to these studies.

%Ghaffarizadeh
Inclusion of an immune response and its effect on tumor growth can be modelled with PhysiCell as demonstrated by Ghaffarizadeh and collaborators.\cite{Ghaffarizadeh2017} In order to model immune response they first modelled an oncoprotein secreted by Cancer cells that can then trigger the biased migration of other agents representing immune cells. These immune cells can then adhere to the cancer cells and have a probability to trigger apoptosis in the concerned cells.

The immune response often corresponding to a type of agent in and of itself. The immune system is such a vast subject that a review as long as this one could be written solely on agent-based models based describing immune system. Therefore contrary to previous sections where implementation was more detailed, here a broader view of the phenomena treated with agent-based model and described in the review of Norton and collaborators will be given.

A first important subject if the impact of the microenvironment from the mechanical point of view as it impacts the immune cells as well. Another studied subject is how the immune response can interact with tumor-induced vasculature in terms of physics but also signalling. The importance of tumor lymphatics also led to a lot modelling efforts on the lymphatic nodes. Immunotherapy, as in taking advantage of the immune system in order better fight cancer has been studied with agent-based models, along with its polar opposite, the tumor enhancing immune cells. The last treated subject in the review in intra tumor heterogeneity which focuses more on the impact of variation of signalling pathways between patients and its impact on the efficacy of therapies.[reread]

From a general point of view these models are usually more elaborated than the model focusing on growth. This comes at the cost of increased complexity. Several type of agents needs to be modelled and the corresponding signalling can often signify that the computational cost might be significant even for smaller systems. As detailed in the article of Ozik and collaborators: "The single sample simulation required approximately 2 days on a four-year-old desktop workstation, including time to save simulation outputs once every three simulated minutes." \cite{Ozik2018} As will be detailed further in the document this can be considered a costly simulation

\section{Implementation aspects}
\subsection{Model evaluation, calibration, validation and sensitivity analysis}
The limited, if growing, computing capability means it is impossible so model an entire physiological tissue, or even a cell. For these reasons agent-based model, like continuous model are necessarily approximation of reality that require  simplification in order to remain tractable. Moreover, should the computing power become more available, proper analysis of the data in order to separate modelling artifacts from actual phenomenon would become exponentially more complex or time consuming. In this section, different methods used to assess the performance of an agent-based model will be presented. It will focus primarily on the studies covered in the previous section. In all model it is important to understand what are the important parameters. Once all important parameters are isolated it is also necessary to understand whether they were extracted from experimental data.

In studies where the model is calibrated then compared to experimental data, the model and its set of parameters are usually validated by direct comparison with available experimental data, either produced on purpose or taken from previous studies.\cite{Arrebola2020}\cite{Kempf2010}\cite{Hamis2020}\cite{Mao2018}\cite{Jagiella2016}\cite{Ghaffarizadeh2017}. In case where the model is not directly compared to a given cell lines, studies generally focus on the dynamics and the impact of important parameters.\cite{Cleri2019}\cite{Bull2020} More generally, if a validated continuous model exists on the modelled phenomenon, it should, if possible, be compared to the observed dynamics of the agent-based model. 

\subsubsection{Growth curve}
One of the first and most common assessment of tumor growth agent-based model is the growth curve. The number cells in the model is compared to experimetal data The growth dynamics can vary pretty significantly. For example, doubling time between cell lines can vary between 16h and 64h, and the thickness of the viable rim can range from 100 \textmu m to more than 200 \textmu m.\cite{Freyer1988} However qualitatively, growth curves from tumor spheroids generally exhibit an initial exponential phase before a saturation of growth which follows the establishment of the necrotic core. 

Regardless of whether the model is calibrated with experimental data or its parameters are sweeped in order to study the dynamics, a sensitivity analysis remains necessary in order to be able to isolate the most important parameters. Hamis and collaborators wrote a review about the different tools that can be used in order to perform said analyses. \cite{Hamis2020b} The review focuses mostly on consistency analysis, robustness analysis and Latin hypercube analysis. It underlines the need for a solid mathematical and statistical framework in order to be able to compare models.


\subsection{Implementation challenges \& and perspectives}

\subsubsection{Computational cost}
%Time of execution & number of cells
The review of Osborne once again provide a good starting point to our discussion. His decision to test several models of four test cases is informative of their relative performances and artifacts and can therefore allow better discrimination of model artifacts. Osborne provides run time for each model covered in his studies. As expected, beside the case of long-range signalling, Cellular automata are usually faster than other models. Cellular Potts, however, is systematically slower than any other model and for all four test cases.\textbf{[expand]} While useful to understand how different types of model can perform relative to one another on specific problems, their study treated most problems in 2D and with cell numbers at least an order of magnitude below what can be expected in tumor growth studies. In the following it will be attempted to quantitatively compare the model to one another in terms of implementation more than in terms of results. The goal being to compare this to our objectives and assess the best modelling approach for the specific case of the DIP2G project.

%on-lattice
According to Arrebola and collaborators, with their model, The simulated MTS reach dimensions of the order of a mm in a few CPU seconds with a reduced computational cost. However", the hardware they used is not specified even if it seems they are using st	ate-of-the-art desktop computers.\cite{Arrebola2020} While efficient this approach may lack the complexity required to assess our questions. in their study, Hamis and collaborators also used an off-lattice model and reached cell counts up to $4\cdot 10^{5}$ and a total volume of 2 mm$^{3}$ which is still an order of magnitude below the cm-sized system of the DIP2G project. However, their computing time is not reported in their publication.\cite{Hamis2020} However, the increased mathematical complexity compared to the previously mentioned model(\cite{Arrebola2020}) suggest longer computation times. The model of Mao and collaborators is an hybrid model and therefore closer to what the DIP2G project aims at. Their model of monolayer and 3D aggregates coupled to PDE resolution includes up to 10$^{6}$. As stated in the supplement, [...] the lattice within which cells are located, [...] is sized to accommodate the largest spheroid to be simulated – the default size is 120×120×120." However, the computation time and hardware are however not given.\cite{Mao2018} In the model of Cleri, $3.5 \cdot 10^{6}$ cells are simulated on a cluster, which suggests that an hybrid model with $10^{6}$ cells is hardly tractable with a desktop computer.\cite{Cleri2019} The supplementary material from the publication of Jagiella and collaborators mentions :"The domain of numerical simulation is divided into 100x100x100 lattice points, which corresponds to a total volume of about 2.4 mm$^{3}$". which is similar to the model of Mao and collaborators.

%off-lattice.
While the off-lattice model of Bull and collaborators does not provide a precise maximum number of cells it is interesting to note their strategy for initialisation which starts simulations with 300 cells, when most on-lattice models start with 6 to 10.\cite{Bull2020} The maximum cell number can still be roughly estimated from the data. Indeed, the maximum radius is given in cell diameters units, therefore assuming spheroid are spheres one can deduce their volume in cell radii units. The results is approximately 22,400 cells. Computational times are however not given. Using  PhysiCell,  Ghaffarizadeh and collaborators state that :"By our testing, recent quad-core desktop workstations (with hyperthreading, for 8 total execution threads) can simulate 10-30 days in systems of up to 10$^5$ to 10$^6$ cells in 3 days or less (wall time)." \cite{Ghaffarizadeh2017} In their 2015 article, Kempf and collaborators report they can simulate up to 10$^6$ cells with their 3D off-lattice model.\cite{Kempf2015} 

%more complex models
On-lattice and off-lattice models are the more widespread implementation, but it is also interesting to look at  other models in terms of ressource. It can be found that some model found ways to reduce the computational costs while others dramatically increased it by representing more and more phenomenae. If one takes the immersed boundary model developed by  Rejniak's group, it is stated that "Typically, a cluster of first 50 cells is generated in a few hours on a one-processor (2.7 GHz) personal computer."\cite{Rejniak2007}, which means any large simulation would require a cluster.

Another example is the simulation of immune response performed by  Ghaffarizadeh and collaborators.\cite{Ghaffarizadeh2017} While, the Hanging drop simulation could simulate up to a million cells in 2-3 days of wall time, the immune response simulation required 2 days on a cluster for a tenth of the amount of cells at most. This illustrate very well that, the more physics added, the longer the wall time.

Be it with on or off-lattice model 10$^6$ cells seems to be the limit most studies stop at. This could be explained by the fact that is usually the size of the aggregates studied experimentally. A layer of cells in the DIP2G system contains approximately a million cell. The wall time for such a simulation would then be around 3 days with an off-lattice model run with PhysiCell code ran on quad-core i7 processor. For comparison, the study of Osborne and collaborators on proliferation simulated 1000h of development on 180 cells on a single i7 core yielded wall time between 40 s (Cellular automaton) and 4000 s (cellular potts), with off-lattice models ranging between 1000 and 3000 seconds. Assuming computation time scale linearly with number of agents, the simulation time for 10$^6$ cells would then be between 2 and 230 days on a single i7 core depending on the method used. It should be noted that this does not include the cells of the hematoencephalic barrier, which has been discussed above. 

Two solutions  can be considered in order to save computational resources modelling very large systems. The first one is the many-cell-one-site cellular automaton proposed by Sottoriva and collaborators.\cite{Sottoriva2012}\cite{Sottoriva2015} The other is two reduce the simulated system to a 2D cross-section as proposed by Chen and collaborators. \cite{Chen2018} In their model they reduce the 3D spheroid by studying its cross-section and were able to reproduce the main features observed experimentally in terms of structure.

%"Typically, a cluster of first 50 cells is generated in a few hours on a one-processor (2.7 GHz) personal computer." from the paper of Rejniak
%après calcul une couche du système de diamètre 1,5 cm représente "quand même" 1 million de cellules"

\subsubsection{Implementation of partial differential equations system and coupling to the agent-based model}
Another important part of most the aforementioned models is the implementation of equations or equations that describe the dynamics of nutrients. While the implementation and the nature of the nutrients and chemical compounds was described in the previous section the implementation was not really detailed. This will be done here.

%on-lattice
In the model of Hamis and collaborators, only one nutrient (Oxygen is modelled) and the coupling is straightforward as the solving mesh of the PDE is the same as the lattice describing cell positions.\cite{Hamis2020} In the model of Mao and collaborators, the coupling between the agent and the reaction-diffusion equations is more complex. First the diffusion-reaction equation system is solved in the surrounding medium on a coarse grid which includes some spheoids points. Once done, the concentration is updated over the finer spheroid lattice before being used to reestimate the concentration at the spheroid boundaries in order to reupdate the medium and so on.\cite{Mao2018} This approach is made even more complex by accounting for the difference in diffusion properties between occupied lattice site and unoccupied lattice sites. In the study of Jagiella, the solving method between coupled molecules and uncoupled one was not the same. In both case since the molecular processes are much faster than the cellular ones the steady state solutions are valid. For the coupled glucose-oxygen system a monolithic solver is used.\cite{Jagiella2016} The mesh used for the finite difference algorithm are the same and identical to the "cellular" lattice. In his model Cleri, solves the PDE system with an explicit finite difference scheme.\cite{Cleri2019} \textbf{[put time steps, too]}

%off-lattice
In off-lattice models, both PDE for nutrients and molecules and ODE for the evolution of mechanical positions of cells and force balance need to be calculated. In the model of Bull and collaborators, the equation for oxygen is solved in steady state condition but this time with a finite element solver on regular tetrahedral mesh.\cite{Bull2020} Cells interact with the concentration field  as Dirac point sinks. The solving method fro the ODE is, however, not specified. In the model of Ghaffarizadeh, the ODE part is solved with the forward Euler method for the cell volume and with the second-order Adams-Bashforth method for the cell mechanics.\cite{Ghaffarizadeh2017} The transport and diffusion is handled by BioFVM. In short, the system decouples the equations and solves them separately through use of the finite difference methods (forward and backward). \textbf{[Expand and detail]}
In the 2015 study of Kempf and collaborators, it is stated that:"[The] reaction diffusion equation is numerically solved in a finite difference form, using the Crank-Nicholson scheme under careful implementation of mechanisms, which guarantee the validity and stability of the solution, such as an adaptive maximum stepsize and sanity checks." and "The diffusion of glucose and oxygen is modelled on a cubic reaction diffusion solver system of 1 mm edge length using 71 nodes per dimension. Any off-grid concentration is retrieved or stored in the solver using trilinear interpolation." \cite{Kempf2015}
\textbf{[put time steps, too]}

The strategies for solving the differential equation involved or coupled to agent-based model are varied and most likely driven by a mix of performance demand and algorithms available in-house for the team performing the studies. What can be observed is that as soon as on-lattice model are coupled to equation, the fixed lattice can be challenging to couple to equations if the resolution domains are not the same.

%culture cellulaire sur les cellules du cerveau (sphéroïdes etc...)

\section{Open question arising from literature review}
In this section the authors will take a step backwards and attempt to provide a broader picture on some question that are considered open and not necessarily adressed by any of the mentioned publications. 


\subsection{The choice of nutrients, starvation thresholds and underlying growth mechanisms}
As can be seen in the previous sections, models studying the growth of tumor spheroids tend to focus either on glucose, oxygen or both. In order to build this section, information from the nutrients,  necrosis and quiescence subsections will be reorganised and expanded. In this section, the goal will be less a thorough description of how each models works and more a comparison of the impact of the chosen mechanism on the dynamics. For different model we will answer the following question : what are the conditions for proliferation ? what are the conditions for cell death ?

\subsubsection{Different strategies}
As explained before, Arrebola and Bull only modelled the concentration of oxygen.\cite{Arrebola2020}\cite{Bull2020}. Bull and collaborators encoded both proliferation and cell death on oxygen concentration thresholds.\cite{Bull2020} Interestingly, variation of those thresholds did not impact the growth dynamics significantly and in all cases, the saturation was observed. It is explained by the balance between cell shrinking and removal at the center, and growth/proliferation at the rim. An interesting pursuit to this study would be to investigate the mechanical side of the model as the forces seems to depend on the concentration of oxygen (through cell size). So in this model the growth is purely oxygen-driven. It should be noted that most of their modelling was conducted on a 2D slice of a 3D spheroid. Moreover no quantitative comparison was made outside of the radius of the simulated aggregates. Lastly, the wrinkles and cracks observed in large aggregate could not be obtained in their model without losing the saturation, which thus seems to also be mediated by the surface tension. Quiescence however was purely mediated through oxygen concentratioin

Hamis and collaborators also used an oxygen-based model but the only impact of hypoxia was to lengthen to  G1-phase of the cell cycle.\cite{Hamis2020} Division itself is not conditioned by oxygen concentration either as it depends only on the proximity on a free site. This condition can be understood as a mechanical condition : "no division at confluence". What results from this is the absence of growth saturation in their spheroids. This does not penalise their study that focuses mostly on the interactions between cell-cycle and radiation. Only the initial exponential phase of growth needs to be recapitulated, which is the case in their model. 

In the model of Mao and collaborators, both glucose and oxygen are included.\cite{Mao2018} Interestingly, cells in this model are either growing or dying, and divide once they reached a certain threshold. Cell are tagged for death if they spend enough time below a threshold concentration of glucose or oxygen.  it should be noted that if a combination of glucose and oxygen may favour growth, a combined scarcity of oxygen and glucose does not favour cell death. In short, abundance of one nutrient and scarcity of another can lead to cell death but scarcity of both will only slow growth, possibly more than in the former situation, without ever leading to cell death. However, unlike EMT6/Ro, a experimental reference for this choice was not given. With them being the same physical processes the only difference between the two nutrients come from the value of the parameters. The represented cell line (HCT116) dies quicker without oxygen than without glucose. There is no mechanistic aspect influencing growth in this model. With this dynamics the simulated spheroids seem to slow down, however it does not seem to really saturates as observed in the model of Bull over similar time scales and despite the fact that the necrotic core is present in both cases.

Adding in complexity to the whole picture is the model of Kempf and collaborators in their 2015 study. where they model both glucose oxygen AND a mechanical modulation of growth leading to saturation. AS stated in their 2015 article:"Quiescence of cells is by default triggered if a cell is subject to a critically high
pressure $P_{crit}$ of more than 200 Pa from neighbouring cells at the G1/S-checkpoint." Cell cannot go into necrosis due to hypoxia but only due to glucose deprivation. In that model, the oxygen concentration is modelled in order to account for its impact on cell-cycle and response to radiation. These data are valid for EMT6 anv V79 spheroids. Interestingly, their model is based on the model of Schaller,\cite{Kempf2005} which included glucose and oxygen, and found by comparison with EMT6/Ro data that the condition for the onset of necrosis that should be set in order to reproduce experimental data is depending on the product of glucose and oxygen. Quiescence in their model is only induced by contact inhibition which is supported by experimental evidence for the cell line they are studying.

Jagiella and collaborators provide a more complete view of the same phenomenon studying non-small cell lung cancer (NSCLC) cell line SK-MES-1.\cite{Jagiella2016} They also found that neither glucose nor oxygen alone could lead to representative cell death dynamics when compared to experimental data. However, the "physiological" concentration of glucose and oxygen, when fed into the model lead to underestimation of size and overestimation of necrotic core. They also find that proliferation in their cell-line seemed to be mostly controlled by contact inhibition which was also verified on the EMT6/Ro line. If it recapitulates rather well the growth dynamics it does not explain the observed drop in proliferation near the rim. A more complete modelling of metabolism including ATP improved the agreement but failed to fully capture the observation in terms of necrotic core size. They were only able to reproduce data in all the condition by adding a mediation of cell death and a mediation of cell quiescence by cellular waste and hypoxia. Moreover, in their study, saturation compatible with observations in all configuration was obtained by modelling waste concentration due to cell lysis. Such a conclusion was also formulated in Cleri's model, though not verified.\cite{Cleri2019}

In the model of Cleri, cells proliferate provided they have enough oxygen and glucose. If they are confluent, or under low oxygen or glucose conditions, cell go to quiescence. Cell can only starve due to lack of oxygen and not of glucose. This is approach is interesting to compare to the previous one as they both model ATP production but in different ways and the relation with cell quiescence and starvation is also different.

\subsubsection{A quantitative comparison for hypoxia}
% va falloir parler diffusion à un moment
Qualitative and quantitative behaviour may vary between cell lines. Experimental data should allow determination of the critical mechanism for both quiescence and cell death in relation to hypoxia. in this paragraph a focus will be put on determining a broad trend in quantitative criterion for hypoxia by comparing experiments and simulations on spheroids for different cell lines. In order to understand the impact of the chosen values on growth, the diffusion coefficient will also be compared.

A first observation is that oxygen concetration can be given in terms of partial pressure (mm Hg), percentage or molar concentration (mM or \textmu M) . Equivalence between concentration an partial pressure can be found the work on Grimes and collaborators which establishes a relation between partial pressure and a quantity which is the inverse of concentration. He derives a factor $\Omega$ which he states is equal to $ \rho_{T} \rho_{O_2} K = 3.0318 \cdot 10^7$ mmHg kg m$^{-3}$ with  $\rho_{T}$ = 1000 kg/m$^3$, $\rho_{O_2}$ = 1.331 kg/m$^3$ and $K = 2.2779 \cdot 10^{-4}$ mm Hg  m$^{3}$ kg$^{-1}$.\cite{Grimes2014} However, a quick verification shows that the value for $\Omega$ should in fact be $3.0318 \cdot 10^{-1}$ mmHg kg m${-3}$. In that case, converting a partial pressure of 100 mm Hg which is the order of magnitude used by Hamis and collaborators yields a concentration of 100 \textmu M which is the order of magnitude found in the study of Mao and collaborators as well. Equivalence between percentage and partial pressures are gieven by McKeown.\cite{McKeown2014} %rajouter le calcul du train pour la correspondance avec les mM

Consequently, if Bull and collaborators do follow the work of Grimes and collaborators by setting an external partial pressure of O${_2}$ of 100 mm Hg, then the corresponding concentration is close to 100 \textmu M which matches previous values. Therefore the concentration for hypoxia is between 10 \textmu M and 60 \textmu M, and the concentration for quiescence is 30 \textmu and 70 \textmu M which is 2 orders of magnitude above what was used by Mao and collaborators. It is also above the partial pressure for maximum expression of the most hypoxia markers which is stated to be below 10 mm Hg (approx 10 µM).\cite{Grimes2014}\cite{McKeown2014}. In terms of dynamics, the oxygen diffusion coefficient in tissue was taken as 1750 \textmu m$^2$/sec and the oxygen consumption rate was 20 amol/cell/s, with both values taken from the model of Schaller and Meyer-Hermann\cite{Kempf2005}

%Hamis et Mao 
As Hamis model leaves out starvation and necrosis entirely. However due to the impact of oxygen on hypoxia-activated drugs, its diffusion is modelled. The external concentration is taken to be 10 mmHg and cells are considered hypoxic when pO$_2$ is below 10 mmHg The diffusion coefficient is taken to 2500 \textmu m$^2$/sec outside the spheroids and 1660 \textmu m$^2$/sec within the tissue. The consumption rate is one of the two variables used to calibrate the model on real data and is not given in the article or the supplementary material. 

%Mao
In the study of Mao and collaborators,in their paper, Mao and collaborators simulated culture conditions with O$_{2}$ concentrations ranging between 0 and 0.16 mM/L for HCT116 cells, knowing that cells are considered hypoxic under 0.15 \textmu M/L tagged for death when they stay below this level for more than 24hrs. The diffusion coeffcient is taken to be 2000 \textmu m$^2$/s in the tissue and 5000 \textmu m$^2$/s in the medium. The max oxygen consumption rate in their study was measured at 63 amol/cell/s. But in general the consumption is linked to the concentration through a Hill function. This means that with the parameters of their study (n = 2, K$_m$ = 1.33) for all concentration above 10 \textmu M the rate is effectively maximum.

Cleri, in his model, does not formally model a starvation threshold but considers that if the cell is in oxygen-induced quiescence for long enough, it undergoes necrosis. The chosen threshold is 0.3 mM for an initial concentration of 0.6 mM, which is twice the maximum concentration tested by Freyer in his experiments and reported later by Schaller and Meyer-Hermann in their model. The threshold itself has been taken above the external concentration tested in experiments, and is 20 times the threshold chosen by Kempf and collaborators for hypoxia (which does not lead to cell death). For the diffusion coefficient of oxygen the retained value is 15 \textmu m$^2$/s. It is also taken lower than glucose diffusion coefficient. The oxygen uptake rate is harder to determine due to the equation system used instead of the diffusion-reaction equation used in most other models.

%kempf
In the model of Kempf and collaborators, an external concentration of 0.13 mM (or 60 mmHg) is taken outside the spheroid and the hypoxia limit is taken at 0.014 mM (14 \textmu M approximately 14 mmHg) which is close to the 10 mmHg usually chosen and is supported by experimental evidence on head and neck squamous tumors in mouse. However hypoxia never leads to cell death or quiescence which follows McKeown's review on the matter. The main impact of hypoxia is set to be on metabolism and radioresistance. The diffusion coefficient for oxygen in the original model of Schaller and Meyer-Hermann is 1750 \textmu m$^2$/sec in tissue. This value is used again in the 2015 study of Kempf and collaborators coupled to a value of 3300 \textmu m$^2$/sec in water and the possibly of this coeffcient to vary continuously depending on local cell density. Kempf and collaborators modelled two consumption rates for active and quiescent cells. The oxygen consumption rate for active cells was 83 amol/cell/s and the consumption rate for quiescent cells was 49 amol/cell/s.

An important aspect of the dynamics in both Jagiella model and Freyer experiments in the dynamics for a given cell line is the concentration of nutrient outside the spheroid during growth. In the paper of Freyer from 1986, concentration of O2 was either  0.07 mM/L or 0.28 mM/L. A minimal concetration for oxygen is given at 0.07 mM but in the final model, it is a threshold for quiescence and not viability. Hashem and collaborators measured O$_{2}$ on HCT116 spheroids on day 7 and reported the following :""The general trend is that the internal areas show smaller line widths that correspond (through the calibration curve) to $pO_2$ levels of ~50-60 mmHg. On the other hand, the partial oxygen pressure in the spheroids' external regions, where the signal line width was maximal, is about 120-130 mmHg."\cite{Hashem2015}. The oxygen diffusion coefficient is taken to be the same as Bull and Kempf's studies at 1750 \textmu m/s and its consumption rate Contrary to Mao and collaborators who estimated the diffusion in the medium to 2.5 times higher than in tissue, Jagiella takes the diffusion in medium to be 30 times higher than in tissue.  

The core measurements are however difficult to compare with images obtained with pimonadizole which marks cells with partial pressure below 10 mm Hg and can be clearly seen next to the proliferative rim in pictures taken in spheroids from human melanoma \cite{Raza2017} However, their method does not offer quantitative data on oxygen distribution but only relative concentration between center and rim. in the study of Dmitriev and collaborators , imaging in 250 \textmu m-diameter neurospheres from \textbf{[cell line]} with the NanO$_2$ probes showed a steep gradient from an external concentration of approximately 160 \textmu M to an internal concentration of approximately 50 \textmu M. 

According to Grimes, the EF5 marker also used by Mao responds to oxygen partial pressures below 10 mm Hg which is equivalent to 10 \textmu M suggesting that the limit chosen for hypoxia by Mao is low as cells are shown to be hypoxic down from 10 \textmu M. This is supported by the fact that proliferation markers tend to vanish in area of  hypoxia. Results from Grimes and Mao are in agreement with the quantitative measurement in terms of oxygen pressure at the core of small (200-250 \textmu m diameter) spheroids suggesting that in that case, the partial pressure only drops to 25-50 mm Hg ($\approx$ 25 to 50 \textmu M)  but drops close to zero in larger aggregates  ($>$ 400 \textmu m diameter). interestingly, in figure 4 of their article, when bull and collaborators set their threshold for hypoxia at 0.1, (10 mm Hg) they obtain a morphology similar to that observed by Grimes et al. on DLD1 spheroids and Mao et al. on HCT116 spheroids at day 7.

Ghaffarizadeh and collaborators also represented oxygen only this time using the values found in McKeown's for oxygen concentrations.\cite{McKeown2014} However, they do not model glucose metaoblism or concentration which could be considered important in that configuration. In the model of Ozik and collaborators on which the previous article is based, it is stated that several values of oxygenation ranging from 0 to 60 mmHg were tested but the threshold for hypoxia itself is never explicitly given.\cite{Ozik2018} However, the data presented in figure 3 suggests that cells die between 5 mmHg and 8 mmHg of partial pressure. In terms of dynamics, the diffusion coefficient used is not explicitly given but is specified in their previous publication on BioFVM to be 1670 \textmu m$^2$/s. \cite{Ghaffarizadeh2015} In this article, the uptake rate is also given as 0.1667 kg/m$^{-3}$/cell/s. In order to compare to other value with others reported elsewhere we try to convert it to a value in mol/cell/s. assuming a cell radius of 7.5 \textmu m, we obtain a cellular volume between 1761 \textmu m$^3$ (perfectly spherical cell) and 3375 \textmu m$^3$ (perfectly cubic cell). The molar mass of oxygen being 32 g/mol, this leads to a cellular uptake rate between 9e-15 mol/cells/ and 17.5 mol/cells/s. This value, assuming the calculation holds, is a 1000 times higher than other reported values. 

% then you need cell volume and molar mass... %if R = 7.5 µm Vcell = 1761 µm^3 for spherical cell. and if the cell is cubic Vcell = 3375 µm^3 
%donc en µm -> [1.761e3 ; 3.375e3] µm^3 -> [1.761e-6 ; 3.375e-6] mm^3 -> [ 1.761e-9 ; 3.375e-9] cm^3
%  [0.29e-9 ;  0.56e-9] g/cell/s en g/cm^3 c'est non...
%[kg/m³] = 0,001 [g/cm³] ->  

% [1.761e-15 ; 3.375e-15] m^3 -> [0.29e-15 ; 0.56e-15] kg/cell/s -> [0.29e-12 ; 0.56e-12] g/cell/s -> [0.009e-12 ; 0.0175e-12] mol/cell/s [9e-15; 17.5e-15]  
% 

The final study that the authors want to mention on the question of hypoxia is the older study of Schaller and Meyer-Hermann which puts the threshold for the product of oxygen and glucose at 0.025 mM$^2$. If as modelled by Mao and by Cleri (lower concentration of glucose), a 5 to 10-fold ratio is assumed between oxygen concentration and glucose concentration in mM, then one can assume that the thresholds for cell death would be between 70 \textmu M and 25 \textmu M for Oxygen and possibly an order of magnitude lower or more if glucose is more abundant or if, as is stated in several publications, energy needs are covered through metabolic mechanisms, specifically anaerobic ones. 

\begin{table}[h]
\begin{center}
\begin{tabular}{ |p{22mm}|p{18mm}|p{20mm}|p{20mm}|p{20mm}| p{20mm} | }
 \hline
 \textbf{Study} & \textbf{External O$_2$ concentration } (mmHg) & \textbf{Hypoxia threshold} (mmHg) & \textbf{Tissue diffusion coeff.} \textmu m$^2$/s & \textbf{Cellular O$_2$ cons.rate}\ (amol/cell/s) & \textbf{Cell line}  \\
 \hline 
 \hline
Bull et al., 2020 & 100-150 & 10-105 & 1750 & 20 & EMT6/Ro*  \\
\hline
Hamis et al., 2020 & 100 & 10 & 1670 & variable. & HEMC-SS \\
\hline
Mao et al., 2018 & 75* & 0.07/0.47** &  2000 & 63 & HCT116  \\
\hline
Cleri, 2019 & 280/1400 & 140 & 15 & N.S & EMT6/Ro \\
\hline
Kempf et al., 2015 & 61 & 6.6 & 1750 & 83 (active) \ 49(quiescent) & EMT6/Ro + DS carcinosarcoma \\
\hline
Ghaffarizadeh et al., 2017 & 0-60 & 5-8 & 1670 & 9000-17500 & None \\
\hline
Jagiella et al., 2016  & 30 ; 130 & 0.7(***) & 1750 & 90-230 & SK-MES-1 \\
\hline 
\end{tabular}
\caption{summary of the quantitative comparison for oxygen \ *By default when values are taken from  Schaller's study, The cell line is EMT6/Ro (see text.)   ** inconsistent value between text (0.15 \textmu M) and figure (1 \textmu M) *** max value where ATP production can be insufficient for survival}   
\end{center}
\end{table}
% mcKeown : rapport p02/pourcentage = 0.096
%conversion mM/h <-> mol/cell/s : 1 mol/cell/s = 13.3 × 10^17 mM/h

The discussion of McKeown is very instructive. In her review, she insists on the nuance between different definition of hypoxia and discuss the general assumption in models to have a boundary partial pressure in the range of 100 mmHg to 160 mmHg. She notably suggests that the partial pressure in tissue conditions is in fact closer to 50 mmHg and suggest physioxic concentration should be set at 38 mmHg. Her focus on that subject is supported by a later study of Gomes on HCT116 showing a significant impact of the "physioxic" concentration on spheroid growth compared the often used normoxic one. These value may results in oxygen concentration that are actually lower than those found in some models suggesting that hypoxia alone at 10 mmHg may not lead to starvation. Starvation-inducing level of oxygen regardless of other parameters may be as low as a tenth of that. This is supported by studies that focused on metabolism and found that the energy requirements of tumor cells in many cell lines can also be assured through anaerobic metabolic pathways.\cite{Khaitan2006}\cite{Yu2017}\cite{Rodriguez2008} This discussion naturally leads to an analog reflection on glucose.

In terms of dynamics a measured value by Grote and collaborators was $D$ = 1.75$\cdot$10$^{-5}$ cm$^2$/s = 1750 \textmu m$^2$/s \cite{Grote1977} \textbf{[check how]} 
Most studies seem take this value for the diffusion coefficient of oxygen. For the consumption rate or uptake rate of oxygen in spheroids, the 1986 study of Mueller-Klieser suggests that the consumption rate varies with spheroid size. It should be noted that the consumption rate given in their study is scaled by the amount of viable cells meaning that there is an actual decrease in consumptioin taht is not simply due to the decrease in the amount of viable cells. \cite{MullerKlieser1986}	 It is however, stated clearly that this depends on the cell line and therefore such behaviour should not be assumed for all cell line. The vastly different values proposed by Cleri are due to the fact that :"such diffusion coefficients do not refer just to the permeability of the cell membrane, but to some effective combination of cell properties and cell density, which overall determine the ability of nutrients to penetrate the volume of interest." in our, case most model seems to be interested in extracellular diffusion which does not include possible uptake of nutrients and therefore should be higher if physically defined so.

\subsubsection{A quantitative comparison for Glucose}
Fewer models among those presented above include glucose concentration compared to those including oxygen concentration.

In the model of Mao and collaborators, glucose and oxygen are treated almost symmetrically. The models are the same but the constants are different. Glucose generates faster growth in the Hill equation. The threshold for glucose and oxygen starvation are taken at the same value (0.15 \textmu M) which are both assumed.\cite{Mao2018} In experiments and the model, they used a medium concentration of glucose of 5 mM, which is considered to be the "physiological" concentration for spheroid growth.\cite{Freyer1986}\cite{Jagiella2016} In terms of dynamics, their study is a very interesting one as they measured a glucose diffusion coefficient through their MCL of HCT116 and found 20.8 \textmu m$^2$/s in tissue and 874 \textmu m$^2$/s in medium. It is not specified if the two optical isomers of glucose were used at the same time or not. It should also be noted that the thickness of the layer sugests that the coefficient of diffusion is estimated for viable (and proliferating?) cells which may be different from that at the center of the spheroid. The maximum cellular glucose uptake rate was taken to be 71 amol/cell/s.  The rate is also calculated through a Hill function and with the chosen parameter in the study, (n=2 K$_m$= 92) is effectively maximum for all concentration above 1 mM [vérifier si y'a des données sur l'état des cellules dans la couche]

The model of Kempf and collaborators in their article of 2015 is also set at the middle ground in term of glucose with 5 mM. Their choice of of 0 mM for glucose starvation is interesting when linked to their treatment of hypoxia(see above). Glucose depletion can only lead to cell death and not quiescence, suggesting that cells adapt to hypoxia by changing their metabolism until nutrients are fully depleted as suggested by several works on the subject.\cite{Rodriguez2008} This choice also constitutes a departure from the model of Schaller the previous work is based on. Indeed, in the model of Schaller, cell death was condition by the product of glucose and oxygen being below a certain threshold. It should be noted however that these two conditions are not imcompatible as a near zero level of glucose means the product of the two concentrations will be close to zero as well. In terms of dynamics glucose diffusion coefficient has been taken as 105 µm$^2$/s in tissue and 690 µm$^2$/s, and its uptake rate was 95 amol/cell/s in the model of Schaller. It was later taken at 180 amol/cell/s for active cells and 130 amol/cell/s in their 2015 study.

In terms of nutrients, in the model of Jagiella, the use of several nutrients concentration led to the conclusion that an oxygen/glucose threshold could not recapitulate experimental observations. Therefore, cell cycle progression and cell death were conditioned on ATP production which was linked to glucose and oxygen concentration. It should be noted that in there case in order to recapitulate data about necrotic core sizes in different conditions, they had to account for lactate production. The external concentrations of glucose modelled were : 1 mM, 5 mM and 25 mM Of course, the indirect link between glucose and ATP makes quantitative comparison more difficult. But if figure 8 from the article is followed the threshold above which ATP is sufficiently produced to prevent cell death (900 mM/h) regardless of the (studied) oxygen concentration [1 \textmu M - 1 mM] is 50 \textmu M. But if oxygen concentration is sufficient it can be as low 10 \textmu M. This is still two orders of magnitude above what was used by Mao and collaborators on HCT116 cells and more than the zero value chosen by Kempf and collaborators in their model. The oxygen diffusion coefficient in the tissue is taken to be the same as Kempf and collaborators at 105 \textmu m/s

In the same vein, Cleri proposes a simplified model linking glucose and oxygen concentration to ATP concentration. It is a bit more complex than the simplfied equilibrium equation of Jagiella. It includes the dynamics of ADP as well. However, the threshold on viability is set neither on glucose or ATP, but oxygen. ATP is also not given in terms of production rate but in terms of ATP/ADP concentration ratio which prevents any direct comparison on those quantities. The chosen glucose threshold for proliferation in 5 mM with an external concentration either just above the threshold (5.7 mM) or 5 times the threshold (25 mM) Obviously the two results in very different growth dynamics with an initial plateau for the poorly fed spheroid. Such an initial plateau phase was however not observed for experimental spheroids.\cite{Freyer1986}\cite{Freyer1988} The glucose diffusion coefficient in tissue is chosen to be 375 \textmu m$^2$/s. As for oxygen, the glucose uptake rate is harder to determine due to the equation system used instead of the diffusion reaction equation.

\begin{table}[h]
\begin{center}
\begin{tabular}{ |p{22mm}|p{18mm}|p{20mm}|p{20mm}|p{20mm}|p{20mm}| }
 \hline
 \textbf{Study} & \textbf{External G concentration } (mM) & \textbf{Starvation threshold} (mM) & \textbf{Tissue diffusion coeff.} \textmu m$^2$/s & \textbf{Cellular G cons.rate}\ (amol/cell/s) & \textbf{Cell line}  \\
 \hline 
\hline
Mao et al., 2018 & 5 & 0.15 $\cdot$ 10$^{-3}$  &  20.8 & 71 & HCT116  \\
\hline
Cleri, 2019 & 5.7/25 & 5 & 375 & N.S & EMT6/Ro \\
\hline
Kempf et al., 2015 & 5 & 0 & 105 & 180 (active) \ 130(quiescent) & EMT6/Ro + DS carcinosarcoma \\
\hline
Jagiella et al., 2016  & 1/5/25 & 3.2$\cdot 10^{-2}$(***) & 105 & 140-531 & SK-MES-1 \\
\hline 
\end{tabular}
\caption{summary of the quantitative comparison for glucose \ *By default when values are taken from  Schaller's study, The cell line is EMT6/Ro (see text.)   ** inconsistent value between text (0.15 \textmu M) and figure (1 \textmu M) *** max value where ATP production can be insufficient for survival}   
\end{center}
\end{table}

In experiments, Muller-Klieser, Freyer and Sutherland showed that for EMT6/Ro spheroids, an external concentration of 0.8 mM of glucose was sufficient to grow spheroids. Therefore, the threshold for glucose-induced starvation is necessarily lower than that value.\cite{Freyer1986}\cite{MullerKlieser1986}. Glucose diffusion was measured using the method of L-glucose by Casciari and collaborators in both EMT6/Ro and HT29 spheroids.\cite{Casciari1988} The value found for EMT6/Ro (105 \textmu m$^2$/s) is the one used by Jagiella and Kempf in their studies. It is interesting to compare the one found by Mao on HCT116 MCL with the same technique, to the one found on HT29 spheroids. The value found on HT29 is 29 \textmu m$^2$/s. This value is close to that found on HCT116 by Mao, which was expected as they are both human colorectal cancer cell lines.%in an 83 paper Freyer et al. measured 42 in spheroids for glucose...is ok. they used inulin which may bind.


\subsubsection{A comparison for Quiescence}
In some models quiescence is left out entirely. In the model of Mao and collaborators quiescence is not directly modelled. Indeed cells under hypoxia or glucose starvation just grow more slowly. Assuming a Hill coefficient of 2.5 for oxygen, and constant glucose supply, growth rate in hypoxic region ([O$_2$] = 1 \textmu M) can be as low as a third of that of well-oxygenated region. ([O$_2$] = 100 \textmu M) The same calculation for glucose assuming a Hill coefficient of 1.6 yields (Hill coefficient values were found after a brief internet as it is not known if the actual value is 1 or 2 depending on the used solver...). Glucose variation is even more important and can make the growth rate sweep 2 orders of magnitudes across the aggregates. With this in mind, it can be said that cells past the diffusion limit of oxygen and glucose are effectively quiescent.This is corroborated by figure 5 of the article where approximately 20 \% of viable cells at day 10 are neither S-phase, nor hypoxic.

%Bull
In the model of Bull, Cells enter quiescence if their oxygen concentration falls below a threshold value between 30 and 70 mmHg of oxygen partial pressure.\cite{Bull2020} The cell cycle is determinsitically and instantly stops when the threshold value is passed. 

%Hamis 
In the model of Hamis, Cells enter quiescence is no free space is available in 3rd order neighboorhood. Considering cells do not randomly jump sites and apoptosis and necrosis are not modelled, only cells 3 to 5 layers from the spheroid surface can be proliferative. This can be considered a fully mechanistic inhibition. 

%Mao 
As stated in the previous subsections, Mao and collaborators did not implement an explicit quiescence mechanism in their model. However, the growth rate of cell being determined by a product of Hill functions of the glucose  and oxygen concentrations

%Kempf
Schaller and Meyer-Herrmann choice for quiescence mediation is motivated by experimental observations,\cite{Aplin1999}\cite{Helmlinger1997} and previous modelling efforts. \cite{Galle2005} Contact inhibition is the only mechanism that can induce complete quiescence. When the cell undergoes and external  pressure of 200 Pa, it goes in quiscence Even cell cycle and growth are modelled, they do not depend on nutrient concentration and therefore there is no other way for quiescence to be achieved in the model.\cite{Kempf2005}\cite{Kempf2015}

%Jagiella 
In the model of Jagiella and collaborators, the primary method for quiescence mediation is the conjugated presence of matrix and the vicinity of free space. while matrix presence acts in heaviside manner, on division probability, the decay of division probability due to free space vicinity is exponential. With the chosen parameters, quiescence is essentially achieved in depth in excess $\approx$ 500 \textmu m. Otherwise, quiescence can also be mediated by waste and underoxygenation building up inside the spheroid. 
%lire bien la section du S1 qui traite de  ça 

%Ghaffarizadeh

%Cleri
Quiescence in Cleri can be obtained if glucose or oxygen fall below a certain threshold or if the cell is confluent.

\subsubsection{A comparison for Cell death}

%1 mM = 1 mM/L = 1 mol/m3 => 32 g/m3 (02) => 0.032 kg/m^3  bon Bull je comprends pas
% => 0.1 mM = 0.0032 kg/m3 = 3.2 10^-3 kg/m3%
%=> 0.07 mM = 2.24 10^-3 kg/m3 -> omega  = 3.032e7 mmHg m3/kg -> p(0.07 mM) = 2.24e-3 * 3.032e7 ~ 7e4  = 70 000 mm Hg

% pO2 = 10 mmHg ->  c = 10/3.032e7 = 3.32e-7 kg/m³  -> 3.32e-3 g/m3 -> 1e-4 mol/m3 -> 1e-4 mM -> so in Hamis concenration were aroung 1e-3 mM for well oxygenated cells which is still a lot below what Freyer did 

%note saturation may mean constant size after 20 days OR solid inflexion depending on the concentration 
%for Mao most plots are in mM
%bull 1 = 3.032e-7 kg/m^3  = 3.032e-4 g/m^3 =  0.09475e-4 mol/m^3 = 9.475e-6 mol/m3 = 9.475e-6 mM/L alors apparemment il suit 12  ou pinf = 100 mmHg -> 32.98e-7 kg/m^3 -> 32.98e-4 g/m^3 -> 1.01e-4 mol/m^3 = 1.01e-4 mM/L -> donc effectivement bull a du considéré l'équivalent de 100 mmHg hors du sphéroïde.  -> 3.298e-6 kg/m3 = 3.298e-3 g/m3 -> 0.101e-3 mM/L -> 0.1 µM/L

%muller kliesr 150 mm Hg -> 4.94e-6 kg/m^3 =4.94e-3 g/m³ = 0.15e-3 mol/m3 = 0.15e-3 mM/L  = 0.15 µM/L

%bull dernier essai p = omega*c => 100/(3.0318e7) =  3.298e-6 m3/kg ->  0.3032e6 kg/m3 = 9.475e6 mol/m3 =9.475e6 mM/L = 

\subsubsection{Discussion on nutrients availability and resulting growth dynamics}
The assumption that O$_2$ is the limiting nutrient for tumor growth and more particularly spheroids seems to be heavily discussed. In her analysis, McKeown details how cells and particularly can survive sever hypoxia for up to several day through use of glycolysis for their energy needs. \cite{McKeown2014} Her review also supports the range of viable rim diameter being between 70 and 200 \textmu m, which means a mm-size system should in fact be able to reproduce the important gradients in oxygen.

Interestingly, the metabolisms of oxygen and glucose seem to have non-trivial links. The 1986 study of Muller-Klieser and collaborators states the following :"For example, the averagecentral Po2 in spheroids with a diameter of 700 \textmu m dropped from 30 mmHg to 15 mmHg and O mmHg, as the glucose concentration in thegrowth medium was lowered from 5.5 mM to 1.8 mM and 0.8 mM, respectively."\cite{MuellerKlieser1986} This suggest an active role of cells in the process of diffusion of oxygen, with cells being less permeable, or consuming more oxygen when their metabolism decreases. Interestingly, the trend is reverse in larger spheroids. For MEMT6/Ro spheroids, even spheroids with diameter in excess of 700 \textmu m are shown to have non zero central concentration in standard growth conditions. 

From a pure modelling point of view, the use

\section{Focus on DIP2G Project}
The previous sections were written in order to provide a broad view of the field of agent-based modelling applied to cancer biology. The next section will focus more on the core subject of the DIP2G project. Diffuse midline glioma and more specifically, diffuse intrinsic pontine glioma. Contrary to Glioblastome who have been studied thoroughly in the last decades with various tools[refs?], DIPG remain both hard to treat and to study due to their position in the brain and the fact that it develops only in children. For the specific scope of the DIP2G project. It is noted that DIPGs are hypoxic tumors (\textit{in vivo}) which as a lot of implication on their behaviour and notably on radio resistance.\cite{Cook2021}


\subsection{Model systems for DIPGs and DMGs}
An interesting question concerning the DIP2G project is :Have spheroids been used as a platform/model system for biological studies focusing on diffuse midline glioma ? A recent study from Rahal and collaborators used spheroids from three different diffuse midline glioma cell lines in order to study their response to a combination of Atorvastatin and GK126.\cite{Rahal2022} What they found was that those 3 cell lines could form spheroids before drug exposition and were not able once expose to the drugs. A first comment on this study is the terminology. Indeed, three cell lines were used and two of them were immortalized while one was made of primary cells. This technically makes the third line (BXdmg1) a tumorsphere assay.\textbf{look up DMG/DIPG tumorspheres} The main difference with the DIPG of the project is that those spheroids were formed in mixture of methylcellulose and serum-free medium. Culture conditions for some DIPG cell lines are described in the work of Grasso and collaborators. \cite{Grasso2015}%DMSO is the drugless drug solvent so it's used as control

A quick literature review showed that immortalising DIPG cells lines can be challenging, which does not favour the monoclonal spheroid experiments that are mentioned earlier in this document.\cite{Sun2019}\cite{Meel2018} that there existing more profuse literature on sphere-forming assay on DIPG cells with stem cells/progenitor cells rather than immortalised cell lines.

In the DIPG project, the cell line used will be mainly the DIPG7 cell line. This cell line presents the histone mutation H3K27(?). In terms of culture conditions, when outside of the chip they are typically grown in non-adhesive condition in serum-free medium with growth factors and form spheroids. They are then dissolved and filtered of dead cells and waste material in order to seed them within the tumor-on-chip system that will be presented in the next section. These cells are primary tumor cells that forms rather homogeneous population of spheroids made of olidodendrocyte-type cells. \textbf{check with Alessandro} 

\subsection{DIP2G tumor-on-chip system}
The DIP2G project focuses on understanding the processes at play in the response of brain tumors, more specifically diffuse intrinsic pontine gliomae. For that purpose, a system was designed and is currently development in order to better reproduce the tumor microenvironment in order to better assess the response of tumor cells to treatments based on drugs, radiation therapy or a combination of both. The impetus for the establishment of such a system is that reproducing cancer tissue at a scale comparable to those found in patient is necessary in order to study the impact of hypoxia in realistic physical configuration.

The system is made of cylindrical well with a diameter of 1.5 cm and a height of 750 \textmu m. This well is connected to a microfluidic system which enables the supply of fresh culture medium ensuring proper supply of nutrients, oxygen and possibly drugs. Another component of the system is an insert constituted by a grid with endothelial cells on top and pericytes at the bottom. In a configuration analog to that used by Mao and collaborators to evaluate diffusion coefficient in spheroids \cite{Mao2018}, this insert is used to represent the blood brain barrier, which is thought to play an important role in the response DIPGs to pharmaceutical treatments. \textbf{[mettre la ref d'Alessandro (Deligne)]} A dialogue between a 2D layer of brain (DIPG7 ?) cells and the barrier has been demonstrated in the study of Deligne and collaborators.

The cells are seeded within a mixture of hyaluronic acid and matrigel (80/20) used to reproduce the microenvironment of DIPG cells. Indeed Hyaluronic acid has been identified as the major component of brain matrix. Matrigel is then used both to "complete" the recreated microenvironment but also for practical reason as it decreases the reticulation time of the mixture. The resulting cell pellet is left to grow for up to 5 days before imaging is performed on the system in order to study quantities of interest. The system is considered to be homogeneous in the vertical direction. Indeed the presence of the upper and lower plate ensures that cells has no contact on with the culture medium on the top and bottom of the pellet. This ensures the establishement of a radial pattern of nutrients and oxgyen.

The system can be described as tumor-on-chip as the microfluidic system is used to control tumor microenvironment. Microfluidic systems have already been used to study gliomae, but not specifically on DIPGs or with consideration of the blood brain barrier.\cite{Liu2021} 

To the knowledge of the authors, only one study using both agent-based models and tumor-on-chip has been published.\cite{Torab2021} They used a matrigel and collagen system over which they seeded heterogeneous populations of tumor cells in order to study invasion. They then used a cellular automaton to model the interaction of NOTCH1 and DLL4. However, they did not modelled their tumor-on-chip experiment with the ABM. This opens an interesting opportunity for the study of these specific systems in silico. In the next section another prinicpal component of the system is the blood-brain barrier will be presented.


\subsection{Blood-brain Barrier}
The DIP2G project will focus among other things on the impact of the blood-brain barrier on drug efficacy and its subsequent interplay with radiation therapy. Therefore it is important to assess how it could be modelled within the framework of an agent based-model. First, a definition of the Blood-brain barrier will be given, then the available literature on blood-brain barrier will be shortly surveyed in order to assess how it should be modelled.

As stated by Daneman and Prat:"The blood–brain barrier (BBB) is a term used to describe the unique properties of the microvasculature of the central nervous system (CNS). CNS vessels are continuous nonfenestrated vessels, but also contain a series of additional properties that allow them to tightly regulate the movement of molecules, ions, and cells between the blood and the CNS."\cite{Daneman2015} Regarding its composition they also state :"Blood vessels are made up of two main cell types: [endothelial cells](ECs) that form the walls of the blood vessels, and mural cells that sit on the ablumenal surface of the EC layer. The properties of the BBB are largely manifested within the ECs, but are induced and maintained by critical interactions with mural cells, immune cells, glial cells, and neural cells, which interact in the neurovascular unit". Morphologically speaking, endothelial cells forming the BBB are extremely thin:"with a distance of less than a quarter of a micron separating the lumenal from the parenchymal surface". Other cell types forming the blood-brain barrier \textit{in vivo} are the mural cells (mostly pericytes), Astrocytes and immune cells. Regulation of the permeability is achieved through a mix of tight junction and low transcytosis of the endothelial cells.\textbf{[no more detail for now]}

In the specific context of the DIP2G project, the BBB will be modelled experimentally by a transwell system. As stated by Sivandzade and Cucullo in their review :"Transwell system is essentially a side by side vertical diffusion system which comprises a microporous semipermeable membrane (on which cell can be seeded submerged in feeding medium) that separates the vascular and parenchymal side compartments."\cite{Sivandzade2018} This kind of system is well suited to transport studies, however monolayer nature means that endothelial phenotype is different from the one encountered in vivo, which may lead to increased permeability of the transwell compared to in vivo cells, especially with hydrophilic substances. In the DIP2G project, the model used will be a coculture of endothelial cells and pericytes separated by a layer of PET playing the role of basal memebrane. Similar to what was said before, the difference between PET and the actual basal membrane and the 2D nature of the pericyte layer means the biology may present significant difference with the \textit{in vivo} situation, meaning any results should be analysed with caution. 

The question that will be adressed in the following is: "How to model the Blood-brain barrier in the context of an agent-based model ?"
A quick literature survey showed that only one study used an agent-based model where the blood-brain barrier was explicitly represented. Pennisi and collaborators studied the dynamics of multiple sclerosis with the help of an agent-based model.\cite{Pennisi2015} In their model, the BBB is represented as an agent which can see it permeability modified by interactions with cytokines. They concluded that in order to help with multiple scleroris, drugs preventing the opening of the BBB through interactions of cytokines would be helpful.

Another study that might be helpful in this consideration is that of Mao.\cite{Mao2018} If, at first, we assume the blood-brain barrier to act passively, then a diffusion assay similar to the one they performed on spheroid could be perfomed on the transwell system in order to assess an effective diffusion coefficient to be applied to the system. %l'étude de Boujelben pourquoi pas mais il modélise pas la BBB dans "Multimodality imaging and mathematical modelling of drug delivery to glioblastomas."


\subsection{Prospective agent-based modelling efforts}
Studies using agent-based model can either explore a given model design by sweeping parameters and performing sensitivity analysis, or they can focus on trying to reproduce experimental data. In this section, the prospective experimental observable that will be included in the model will be presented. For each quantity, the means of retrieval, the potential spatial averaging or noise properties, and the contributions of different parts of the system (cells, matrix, microfluidics) will be studied.

Experimental data that may be reproduced by our model is typically acquired through fluorescence microscopy. This is the most versatile and practical way of acquiring such data while keeping the spatial information which this project seeks to focus on. Data processing and comparison to the model is non-trivial. The most straightforward example is that of fluorescent marker that is not 100\% in its binding. If it binds to the matrix instead of the cell component it was intended for, then matrix signal must either be removed in post-processing, or another marker should be used to help discriminate between relevant data and background noise.


\subsubsection{Cell death and viability}
The evolution of the population will be followed by a two markers : Caspase for cell death and calcein for cell viability. This should allow quantification of live cell within a cross section of the system. DAPI can also be used to mark viable cells.
Necrotic cells can be marked with Propidium Iodide (PI)  and apoptotic cells with Annexin-V FITC.\cite{Khaitan2006}\textbf{[other refs]} Interestingly, Khaitan and collaborators note that necrotic cells were "not confined to the centre of the spheroid, but distributed at certain discrete foci."\cite{Khaitan2006} The study of Khaian and collaborators on human glioma cell line shows that both apoptosis and necrosis are occuring until at least 20 days of growth even though necrosis tends to prevail as the spheroid ages. 

\subsubsection{Proliferation}
Proliferation can be stained with Ki67 \cite{Grimes2014}\cite{Ghaffarizadeh2017} or with equivalent of Thymidine such as 5-ethynyl-20-deoxyuridine(EdU) or  5-bromo-2'-deoxyuridine (BrdU) can be used to stain DNA-synthesis acitivity within nuclei, and generally identify S-phase cells. It should be noted however that (tumor?) cells may be in S-phase and exhibit a behaviour akin to quiescence in certain conditions, such as low pH oxygen concentration, or glucose concetration. \cite{Zolzer1999}\cite{Khaitan2006} In order to detect these cells, Zolzer and collaborators use a double-parameters approach where S0-quiescent cells needs to be BrdU-negative. Ki67 can also be a way of assessing the actual proliferation rather than DNA content. The proportion of these quiescent S-phase cells seems to increase in harsh environments.

\subsubsection{Hypoxia}
As stated by Raza and collaborators "Efficient cellular uptake can be problematic with porphyrins, due to their large size."\cite{Raza2017} Strategies using counterstaining of Ki67 and EF5 allowed to roughly estimates a circular line where the concentration is supposed to be 10\textmu M (or 10 mmHg)\cite{Grimes2014}\cite{Mao2018}. Other strategies have included the use of electron spin resonance\cite{Hashem2015}, which can give a more quantitative picture of $pO_2$ or the use of nanoparticles, sucha as the NanO$_2^{TM}$ probes which also give quantitative spatial imaging of the partial pressure of O$_2$.\cite{Dmitriev2014} \textbf{[talk about the limits]}. Pimonidazole can also be used  as an hypoxia marker. \cite{Onozato2017}

\subsubsection{Metabolism}
Oligomycin can be used to reduce the synthesis of ATP synthase meaning it reduces oxydative phosphorylation, which is (very roughly) one of the main aerobic processes of ATP production.\cite{Tidwell2022} As stated  in their study, oxygen and glucose may not capture the entire metabolism :"In low-oxygen conditions, as found in the core of large spheroids, glutamine also makes aerobic glycolysis more effective and can sustain cell growth even as the exclusive substrate." suggesting that a) glutamine may play a significant role in some tumors b) interactions between cell death/proliferation and hypoxia are not as straightforward as sometimes presented, hinting that shift to other metabolites occurs when glucose is depleted.\cite{Damiani2017}\cite{Rodriguez2008} It also suggests that the mechanism for metabolism may change from oxydative in young spheroids to glycolitic in old spheroids. \cite{Rodriguez2008} (pH is also stated not to decrease significantly in several cell lines. However, the diameter of spheroids in not specified.)

The question of metabolism for DIPG cells does not seem trivial. According to Grasso and collaborators, the range of growth conditions and medium is varied.\cite{Grasso2015}. The strategy of the project is to work with serum free medium, growth factors and a specific mixture imitating brain matrix compose of Hyaluronic acid and matrigel. Those "non-trivial" conditions for growth begs the following question :"Should metabolites other than glucose and oxygen be included ?" This would entail the estimation or assumption of their diffusion and uptake rates by the modelled cells. Another strategy would be to abstract the nutrients other than oxygen. A single "virtual metabolite" could be described and its assumed characteristics would be adjusted in order to reproduce the observed growth curve. 


\subsubsection{Oxydative stress} 

\subsubsection{"Zero-dimensional" data}
Of course expression gene determined through PCR or cytometry of cell cultures may also prove very relevant but they lack the spatial aspect that may be necessary in order to correctly formulate the model. However, "zero-dimensional" may be used "blindly" while encoding cell-level rules of the model, which could lead to insight on the spatial repartition of said gene activation provided the signalling pathway is included in the model. 

%l'étude de Boujelben pourquoi pas mais il modélise pas la BBB dans "Multimodality imaging and mathematical modelling of drug delivery to glioblastomas."
Agent-based models have been used to conduct studies related to brain tumors. However most of the studies found during the literature survey performed for this study were related to glioblastomes. Boujelben and collaborators used what could be assimilated to an on-lattice agent based model coupled with a vascular model in order to model drug delivery.\cite{Boujelben2016} Another recent study of Kim and collaborators focused more on a specific signalling pathway coupled with an agent based-model.\cite{Kim2015}



\subsubsection{Discussion}
In their study \cite{Khaitan2006} states the following for human glioma cell line spheroids :"In the present study, spheroids grown from an established human glioma cell line (BMG-1) showed an exponential growth pattern up to 28 days in culture, followed by rapid disintegration." and "their cell cycle distribution (G0/G1, S and G2/M phases) did not vary with growth between 7 and 28 days, except that the fraction of S-phase cells actively synthesizing DNA (S-positive cells) reduced drastically from 18\% on day-7 to 5 \% on day-28, with the total S-phase population remaining nearly unchanged at 20\%"\cite{Khaitan2006} which means no saturation was observed, and spheroids disintegrated after 28 days regardless of fresh medium supply.\textbf{[check if other BMG-1 cell line yield the same stuff]}
%read "Simulating PDGF-driven glioma growth and invasion in an anatomically accurate brain domain." for simulation of gliomae with ABM ça je crois que c'est fait....


%read : the role of myosin ii in glioma invasion: A mathematical model. for gliomae



%mechanical vs nutrients based model ?
%neurospheres vs immortalised cell lines: compliqué mais intéressant
%\textbf{[has cellular respiration been modelled with SPN? Can we dot it ?]}


\section*{to be treated}

27/01/2023 : algo de voronoi sympa présenté dans la ref 21 et 22 de Kempf. voir si ça peut améliorer celui de Fabrizio
	read 31 and 32 of kempf 2010 pour voir ce que ça dit sur la quiescence
	read 45  and 51 of Schaller

read "Simulating PDGF-driven glioma growth and invasion in an anatomically accurate brain domain." for simulation of gliomae with ABM

\textbf{and "Strategies of eradicating glioma cells: A multi-scale mathematical model with mir-451-ampk-mtor control."}

[read Roose for interstitial stresses and look the model about solid stresses in more detail]

[use KIM2007 to expand on continuum models]

\textbf{[It should be noted that interstitial pressure could be easy modelled with immersed boundary where the mechanics are already encoded within the model]}

%Yu2020 si j'ai la foi plus tard. en gros ils font plusieurs modèles intéressants en java avec 3 représentations du cycle métabolique. Si je fais l'étude comparative sur le cycle du glucose faudra en parler.

\textbf{[find ref on apoptosis role in tumor cell population. ]}


%https://www.ncbi.nlm.nih.gov/books/NBK9876/ garder ça pour plus tard (grosse ref sur les cellules eukaryotes



1.      Round-table flash presentation (background and interests)

2.      Basics of the project :

-        OxyMEMS origins : a tumor-on-a-chip to better understand the resistance of DIPGs to therapies (Samuel Meignan) 

-        Proofs-of-Principle : generating hypoxic tumors with gradients of cell density (Lisa Terrassoux) 

-        Connecting Tumor-on-chips to Blood Brain Barrier (Salimata Bacari, Anthony Treizebre)

-        Mathematical models for cancer cell growth, oxygen consumption… in spheroids (Fabrizio Cleri) 

-        Description of the Work Packages proposed in the INCa project (Alessandro Furlan)

3.      Biophysical questions to be addressed / how to answer them (experimentally and theoretically) ?

-        Drug distribution, nanoparticle diffusion, interstitial pressure

-        Oxygenation : oxygen sensors (molecular probes, microelectrodes, Oxnano technology … ?)

-        Reactive Oxygen Species/ Metabolism/Radioresistance

-        Matrix rigidity and mecanotransduction (Traction Force Microscopy), fiber reorientation

if you do wide field, you need to slice or you're not getting images at the core...?

hill equation is a  generalised form of Monod equation which was used on bacteria in 1949

\textbf{[In Onzonato, they use Fucci markers on HeLa cells. They do not stain cell death so we do not know about necrotic core... ask alessandro]}

\textbf{keep : "Three-Dimensional Cell Culture Systems in Radiopharmaceutical Cancer Research" for further reference about markings ?}

01/02/2023: \textbf{[Short bibliography on  BMG-1 spheroids to see the general phenotype  as khaitan obtains surprising stuff]} scaffold ?

01/02/2023: \textbf{keep : "The Glycolytic Switch in Tumors: How Many Players Are Involved?"}

06/02/2023: Freyer 83 also give extracellular space fraction

06/02/2023: Lire le papier de Bell2021 sur les gliomes...

07/02/2023: read Voissière in full, lots of information on human 3D cell culture of chondrosarcoma such as reduced cell cycle pace

07/02/2023: read Tyson and Novak too

07/02/2023: "Mathematical modeling of the proliferation gradient in multicellular tumor spheroids" for comparison to results of models could be interesting

20/02/2023:  add meele and the other paper on DIPG to bibliography
\newpage
\bibliographystyle{unsrt}
\bibliography{biblio_synthese}
\end{document}
